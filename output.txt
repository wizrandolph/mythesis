分类号：

密级：

公开

UDC

学号：

2022023414

South China Normal University

硕 士 学 位 论 文
（ 专 业 学 位 ）

FRET 双杂交分析数据处理软件的设计与开发

学 位 申 请 人：
学 科

业：

光电信息工程

论 文 研 究 方 向：

荧光图像分析

所 在

专

魏智强

学

院：

导师姓名及职称：

光电科学与工程学院
胡敏 实验师
陈同生 教授

2025 年 4 月 2 日

FRET 双杂交分析数据处理软件的设计与开发

专业名称： 光电信息工程

摘

申请者：

魏智强

导师：

胡敏

要
福斯特共振能量转移（Förster Resonance Energy Transfer, FRET）技术被广泛用于探

究活细胞中生物大分子的动态相互作用过程，在生命科学基础问题研究、疾病的发生
发展机制探索和药物研发等方面具有广阔的应用前景。FRET 双杂交分析是目前唯一可
以在活细胞内进行生物大分子“滴定实验”的技术，能够定量获得供受体结合的化学计
量比和相对亲和力。
FRET 双杂交分析的数据处理过程繁琐费时，使用门槛较高且难以满足高通量检测
的要求。数据处理过程需要借助 Zeiss ZEN、HCImage、ImageJ、Excel 和 MATLAB 等
多个专业软件进行处理，数据需要在不同软件间进行导入和导出。数据处理过程包括
专家标注感兴趣区域（Region of Interest, ROI）、背景扣除、异常数据过滤、FRET 效率
计算、双杂交拟合计算等过程，共 28 个步骤，单次实验过程需要 3.5 至 7 小时。FRET
图像处理过程依赖人工手动标注 ROI，无法满足高通量等大规模数据场景的应用要求。
为了解决现有 FRET 双杂交分析数据处理流程繁琐、人工操作依赖性强等问题，亟待设
计一款专门研发的数据处理软件，开发对应的 FRET 图像处理算法，以实现 FRET 双杂
交分析数据处理的规范化和自动化。
针对以上问题，本文设计并开发了一款 FRET 双杂交分析数据处理软件 Fretha，支
持从原始图像到化学计量比结果的规范化数据处理，测试了 Fretha 的测量精度和功
I

能，并首次提出了基于明度和均匀度的自动 ROI 选取算法（Luminance-Uniformity-based
ROI selection, LURS），实现了数据处理过程的自动化。本文的主要工作和创新点如下：
（1）首次设计并开发了 FRET 双杂交分析数据处理软件 Fretha。该软件采用分层架
构（表现层、业务层、数据访问层和数据层）构建，封装了 FRET 计算器、图像分析库
和双杂交求解器，实现了 E-FRET（Emission-FRET）、33 -FRET（Three-cube-FRET）、
FRET 双杂交拟合等多模态分析算法。基于 Qt 5.15.2、OpenCV 和 dlib，实现了成像参
数设置、数据校验、FRET 图像处理、数据管理、结果可视化等功能模块。Fretha 的设
计体现了针对 FRET 双杂交分析数据处理的专业性，实现了从原始图像到化学计量比
结果的规范化高效处理。
（2）验证并测试了 Fretha 的准确性、可靠性和功能。应用 Fretha 软件对标准质粒
C4Y/C10Y/C40Y/C80Y 进行手动 33 -FRET 分析和 E-FRET 分析，测量得到的 E A 值分别
为 0.291 ˘ 0.020、0.243 ˘ 0.031、0.159 ˘ 0.018 和 0.118 ˘ 0.019，E D 值分别为 0.307 ˘ 0.040、
0.230 ˘ 0.022、0.155 ˘ 0.011 和 0.117 ˘ 0.012，与文献值的相对误差分别为 3.9%、2.2%。
使用 Fretha 手动分析 C32V 和 CVC 质粒中 Cerulean 与 Venus 的化学计量比，测得在
C32V 质粒中的实验值为 1.071，理论值为 1；在 CVC 中的实验值为 2.023，理论值为 2，
从而验证了 Fretha 手动数据处理的准确性。模块测试表明，Fretha 支持成像参数更新、
异常数据隔离、FRET 图像处理、一键式数据结算和结果可视化等功能运行正常，模块
运行符合设计预期。Fretha 在 48 小时连续运行和高频操作下没有内存泄露等异常情况，
适用于大数据量持续数据处理等场景。
（3）首次提出了基于明度和均匀度的自动 ROI 选取算法 LURS，实现了自动 FRET
双杂交分析。Fretha 显著规范了 FRET 双杂交分析的数据处理流程，提升了数据处理
效率，但是仍然依赖人工标注 ROI。LURS 算法通过多通道自适应阈值分割、变异系
数均匀性评估和连通区域分析，能够识别荧光图像中高信噪比且低变异性的高质量荧
光信号。在标准质粒验证实验中，LURS 方法测量的 E A 、E D 和 RC 值与文献报道值平
均相对误差分别为 5.1%、2.9% 和 3.3%。结合 LURS 和 DC-FRET 方法，自动分析测得
Cerulean 和 Venus 在 C32V 中的结合计量比为 1.063，在 CVC 中则为 1.900，与文献值

II

误差不超过 6.3%。应用 LURS 算法检测活 MCF-7 细胞中 Bcl-xL-Bak 相互作用的化学
计量比，发现加药 A1331852 处理后，Bcl-xL-Bak 之间结合的化学计量比由 1.87 降为
1.12，与手动分析结果一致。对比 SAM-Med2D 和 ilastik 的自动分析方法，LURS 的计
算误差最小，具有更好的鲁棒性。LURS 算法处理 1.4GB 数据集的速度为 6.6 ms / ROI，
峰值内存占用为 800 MB，在性能上优于 ilastik（35.2 ms / ROI，1.8 GB）和 SAM-Med2D
（50.7 ms / ROI，14 GB），更适用于高通量药物筛选等大数据量场景。
Fretha 的推出，简化了 FRET 双杂交分析数据处理的过程的同时提高了标准化自动
化的水平，推动了该技术在生物大分子相互作用研究的广泛应用。

关键词： FRET；FRET 定量分析；荧光图像；FRET 双杂交分析；自动数据处理

III

Design and Development of Data Processing Software for
FRET Two-Hybrid Analysis

Major：

Optoelectronic Information Engineering

Name：

Zhiqiang Wei

Supervisor： Min Hu

ABSTRACT
Förster resonance energy transfer (FRET) technology is widely used to explore the dynamic interactions of biomacromolecules in living cells, and has broad application prospects in
basic research in life sciences, exploration of the mechanisms of disease occurrence and development, and drug development. FRET two-hybrid assay is currently the only technology that
can perform biomacromolecule ”titration experiments” in living cells, which can quantitatively
obtain the stoichiometry and relative affinity of donor-acceptor binding.
The data processing process of FRET two-hybrid assay is cumbersome and time-consuming,
with a high threshold for use and difficult to meet the requirements of high-throughput detection. The data processing process requires the use of multiple professional software such as
Zeiss ZEN, HCImage, ImageJ, Excel and MATLAB for processing, and the data needs to be
imported and exported between different software. The data processing process includes expert
annotation of regions of interest (ROI), background subtraction, outlier data filtering, FRET efficiency calculation, two-hybrid fitting calculation, etc., with a total of 28 steps, and the single
experiment process takes 3.5 to 7 hours. The FRET image processing process relies on manual
annotation of ROIs, which cannot meet the application requirements of high-throughput and
IV

large-scale data scenarios. To solve the problems of cumbersome data processing process and
strong dependence on manual operation in the existing FRET two-hybrid assay, it is urgent to
design a specially developed data processing software and develop corresponding FRET image
processing algorithms to achieve the standardization and automation of FRET two-hybrid assay
data processing.
To address the above problems, this thesis designs and develops a FRET two-hybrid assay data processing software Fretha, which supports standardized data processing from raw
images to stoichiometry results, tests the measurement accuracy and functions of Fretha, and
proposes for the first time an automatic ROI selection algorithm based on luminance and uniformity (Luminance-Uniformity-based ROI selection, LURS) to achieve the automation of data
processing.
The main work and innovations of this thesis are as follows: (1) The FRET two-hybrid
assay data processing software Fretha is designed and developed for the first time. This software is constructed using a layered architecture (presentation layer, business layer, data access
layer and data layer), encapsulating the FRET calculator, image analysis library and two-hybrid
solver, and implementing multimodal analysis algorithms such as E-FRET (Emission-FRET),
33 -FRET (Three-cube-FRET) and FRET two-hybrid fitting. Based on Qt 5.15.2, OpenCV and
dlib, it implements functional modules such as imaging parameter setting, data verification,
FRET image processing, data management, and result visualization. The design of Fretha reflects the professionalism for FRET two-hybrid assay data processing, and realizes the standardized and efficient processing from raw images to stoichiometry results.
(2) The accuracy, reliability and functions of Fretha are verified and tested. The standard
plasmids C4Y/C10Y/C40Y/C80Y were manually analyzed by Fretha software for 33 -FRET
analysis and E-FRET analysis, and the measured E A values were 0.291 ˘ 0.020, 0.243 ˘ 0.031,
0.159 ˘ 0.018 and 0.118 ˘ 0.019, and the E D values were 0.307 ˘ 0.040, 0.230 ˘ 0.022,
0.155 ˘ 0.011 and 0.117 ˘ 0.012, with relative errors of 3.9% and 2.2% respectively. The

V

chemical stoichiometry of Cerulean and Venus in C32V and CVC plasmids was measured using Fretha, with experimental values of 1.071 and 2.023, respectively, which were consistent
with the theoretical values of 1 and 2, thus verifying the accuracy of Fretha manual data processing. Module testing shows that Fretha supports the normal operation of functional modules
such as imaging parameter updates, abnormal data isolation, FRET image processing, one-click
data settlement and result visualization, and the module operation meets design expectations.
Fretha has no abnormal situations such as memory leaks under 48 hours of continuous operation
and high-frequency operation, and is suitable for scenarios such as continuous data processing
of large data volumes.
(3) An automatic ROI selection algorithm LURS based on luminance and uniformity is
proposed for the first time to achieve automatic FRET two-hybrid assay. Fretha significantly
standardizes the data processing process of FRET two-hybrid assay and improves the data processing efficiency, but still relies on manual annotation of ROIs. The LURS algorithm can
identify high-quality fluorescence signals with high signal-to-noise ratio and low variability in
fluorescence images through multi-channel adaptive threshold segmentation, coefficient of variation uniformity assessment and connected region analysis. In the standard plasmid verification
experiment, the E A , E D and RC values measured by LURS method had average relative errors
of 5.1%, 2.9% and 3.3% respectively compared with the literature values. Combining LURS
and DC-FRET methods, the stoichiometry of Cerulean and Venus in C32V was automatically
analyzed to be 1.063, while in CVC it was 1.900, with an error of no more than 6.3% compared
to the literature value. The LURS algorithm was used to detect the chemical stoichiometry of
Bcl-xL-Bak interaction in live MCF-7 cells, and it was found that the binding stoichiometry
of Bcl-xL-Bak decreased from 1.87 to 1.12 after treatment with A1331852, which was consistent with the manual analysis results. Compared with the automatic analysis methods of
SAM-Med2D and ilastik, LURS has the smallest calculation error and better robustness. The
LURS algorithm processes a 1.4GB dataset at a speed of 6.6 ms / ROI, with a peak memory

VI

usage of 800 MB, which is better than ilastik (35.2 ms / ROI, 1.8 GB) and SAM-Med2D (50.7
ms / ROI, 14 GB) in performance, and is more suitable for large data volume scenarios such as
high-throughput drug screening.
The launch of Fretha simplifies the process of FRET two-hybrid assay data processing
while improving the level of standardization and automation, promoting the wide application
of this technology in the study of biomacromolecular interactions.

KEY WORDS: FRET, FRET quantitative analysis, FRET two-hybrid assay, Automated data
processing

VII

目 录
1 绪论 ................................................................................................................................

1

福斯特共振能量转移（FRET） ........................................................................

1

1.1.1

FRET 原理概述 ........................................................................................

1

1.1.2

FRET 在生物学中的应用 ........................................................................

2

1.1.3

基于受体敏化发射的 FRET 定量测量方法（E-FRET） .....................

4

FRET 双杂交分析 ...............................................................................................

5

1.2.1

基于 Langmiur 模型曲线拟合的 FRET 双杂交分析（L-FRET） .......

5

1.2.2

基于 FRET 效率 E D 和受供体浓度比 RC 线性分离的 FRET 双杂交

1.1

1.2

1.3

分析（DC-FRET） ..............................................................................................

7

FRET 分析数据处理方法现状 ...........................................................................

8

1.3.1

FRET 双杂交分析数据处理现状 ............................................................

8

1.3.2

基于机器学习的 FRET 数据处理 ...........................................................

9

1.4

本文的工作内容和意义 ..................................................................................... 10

1.5

本文的章节安排 ................................................................................................. 11

2 Fretha 的设计和开发 ..................................................................................................... 13
2.1

引言 ..................................................................................................................... 13

2.2

需求分析和总体设计 ......................................................................................... 13

2.3

2.4

2.2.1

需求分析 .................................................................................................. 13

2.2.2

模块划分和界面设计 .............................................................................. 14

2.2.3

软件总体框架 .......................................................................................... 16

2.2.4

开发技术选型 .......................................................................................... 19

FRET 算法和后台接口 ....................................................................................... 20
2.3.1

FRET 定量计算器 .................................................................................... 20

2.3.2

FRET 图像处理器 .................................................................................... 21

2.3.3

FRET 双杂交求解器 ................................................................................ 22

功能模块的实现 ................................................................................................. 26
2.4.1

成像参数设置模块 .................................................................................. 26

2.4.2

数据检验模块 .......................................................................................... 27
VIII

2.5
3

FRET 图像处理模块 ................................................................................ 28

2.4.4

数据管理模块 .......................................................................................... 31

2.4.5

结果可视化模块 ...................................................................................... 34

本章小结 ............................................................................................................. 35

Fretha 的验证和测试 ..................................................................................................... 37
3.1

引言 ..................................................................................................................... 37

3.2

材料与方法 ......................................................................................................... 37

3.3

3.4

4

2.4.3

3.2.1

细胞培养与转染 ...................................................................................... 37

3.2.2

FRET 成像系统 ........................................................................................ 38

3.2.3

使用 Fretha 手动处理数据 ...................................................................... 38

结果 ..................................................................................................................... 39
3.3.1

E-FRET 和 33 -FRET 验证实验 ............................................................... 39

3.3.2

FRET 双杂交验证实验 ............................................................................ 39

Fretha 软件测试 .................................................................................................. 41
3.4.1

成像参数设置模块测试 .......................................................................... 41

3.4.2

数据检验模块测试 .................................................................................. 42

3.4.3

FRET 图像处理模块测试 ........................................................................ 43

3.4.4

数据管理模块测试 .................................................................................. 45

3.4.5

结果可视化模块测试 .............................................................................. 46

3.5

Fretha 可靠性测试 .............................................................................................. 47

3.6

本章小结 ............................................................................................................. 49

基于 LURS 的自动 FRET 双杂交分析 ........................................................................ 51
4.1

引言 ..................................................................................................................... 51

4.2

材料与方法 ......................................................................................................... 51

4.3

4.2.1

细胞培养与转染 ...................................................................................... 51

4.2.2

FRET 成像系统 ........................................................................................ 52

4.2.3

基于明度和均匀度的自动 ROI 选取算法（LURS） ........................... 52

4.2.4

基于 LURS 的自动 FRET 双杂交分析 .................................................. 55

实验结果 ............................................................................................................. 57
4.3.1

E-FRET 和 33 -FRET 验证实验 ............................................................... 57

4.3.2

FRET 双杂交验证实验 ............................................................................ 58
IX

4.4
5

4.3.3

活细胞中 Bcl-xL-Bak 化学计量比的自动分析 ..................................... 59

4.3.4

自动分析算法性能对比 .......................................................................... 61

本章小结 ............................................................................................................. 62

总结与展望 .................................................................................................................... 64
5.1

本文的主要内容和总结 ..................................................................................... 64

5.2

展望 ..................................................................................................................... 65

参考文献 .............................................................................................................................. 67
本文创新性说明 .................................................................................................................. 74

X

FRET 双杂交分析数据处理软件的设计与开发

绪论

1

福斯特共振能量转移（FRET）

1.1
1.1.1

FRET 原理概述

1948 年，Förster 首次阐述了福斯特共振能量转移（Förster Resonance Energy Transfer，
FRET）理论 [1] 。FRET 是指处于激发态的供体分子（Donor）通过偶极子间相互作用将
一部分能量以非辐射的形式转移给邻近处于基态的受体（Acceptor）分子（供受体之间
的距离 R 在 0 至 10 nm）[2] 。FRET 的发生会使得供体的荧光淬灭和受体的荧光增强，
其中由于发生 FRET 而增强受体荧光称为敏化发射荧光。FRET 技术突破传统观测局
限，精准解析分子间相互作用与距离 [3] 。在细胞生物学微观环境里，FRET 技术可被用
作一种“分子尺”，可以检测纳米尺度上的生物分子动态，从而进一步研究其结构与功
能。因而，FRET 技术在细胞生物学多领域，如细胞信号转导、蛋白质相互作用探测等
广泛应用。

图 1.1 FRET 过程示意图

理论和实验证明，当供受体荧光分子的距离为 r 时，它们之间的能量转移速率由下
式给出 [4] ：

kT prq “

1 R0 6
p q,
τD r

第1页

(1.1)

华南师范大学硕士学位论文

其中 τD 是供体荧光寿命，R0 为 Förster 半径，由下式表示：
R60 “ 8.79 ˆ 10´5 pn´4 QD J pλqκ2 qpin Åq,

(1.2)

上式中，n 表示介质的折射率，QD 表示供体的量子产率，J pλq 是光谱重叠积分，κ2 是
方向因子，表示供、受体偶极子的相对方向，一般在自由状态下取 κ2 “ 2{3。FRET 发
生需要满足三个条件：（1）r 的数值在 R0 附近，约 0-10nm；（2）供体的发射谱与受
体的吸收谱有超过 30% 的重叠；（3）供、受体偶极子方向不互相垂直。
FRET 效率（E）定义为供体转移给受体的能量与供体发射的总能量的比例，是用
来衡量 FRET 程度的指标，其主要和分子间距和荧光团光谱的重叠度有关。光谱有部分
重叠的供受体分子间距越小，能量转移就越高效。其计算式为：

E“

kT prq
1
kT prq ` τ´
D

,

(1.3)

将公式1.1代入，可以看出 E 与 r 的六次方成反比的关系：

E“

1.1.2

R60
R60

`

r6

“

1
.
1 ` pr{R0 q6

(1.4)

FRET 在生物学中的应用

FRET 发生的条件是供、受体分子之间的距离 r 在 0 - 10nm 之间，这使得 FRET 技
术成为一种“纳米尺”，能够有效地测量纳米级的分子间距，是的 FRET 技术在研究生
物蛋白相互作用、大分子构象变化、信号通路中的蛋白质调节机制等方面得到了广泛
的应用 [5–7] 。
FRET 技术应用到各种生物研究中的重要前提是荧光蛋白的发展 [8] 。1962 年，第
一种绿色荧光蛋白（Green Fluorescent Protein, GFP）在维多利亚水母中被发现，由于荧
光蛋白的无毒性以及稳定遗传性，可以利用基因转导技术将荧光蛋白接到感兴趣的蛋
白质分子上，借助显微成像技术实时观察活细胞中目标蛋白的转位以及信号传递等生
物问题 [9] 。随着基因技术的发展，最先发现的 GFP 蛋白被改造出了多种 GFP 突变体，

第2页

FRET 双杂交分析数据处理软件的设计与开发

多种荧光蛋白的出现为同时追踪多个蛋白质分子间的相互作用和多种蛋白质的共定位
等复杂的生物问题提供了必要条件，使得基于 FRET 显微成像技术在分子生物学和以
及生物物理学的活细胞在体研究得到了广泛的应用 [10] 。
基 于 FRET 技术 在 活细 胞 内实 时 监测 钙 离 子 的 动态 变 化操 作 简单， 灵 敏度 更
高。Cornea 等在 2009 利用荧光共振能量转移技术研究了钙调蛋白（CaM）与骨骼
肌 Ryanodine 受体（RyR1）的结合模式 [11] 。2020 年 Yoon 等开发了一种基于 EGFP 和
Fusion Red 的新型 FRET 钙传感器（FRET-GF-PRed），并结合高频超声（HFU）技术
实现了单细胞水平的精准刺激与成像 [12] 。Yi 等人开发红色电压指示剂 Cepheid1，利用
eFRET 技术实现单细胞电活动与钙信号同步监测，揭示了胰腺细胞电振荡与钙波动的
时空关联 [13] 。
FRET 还可用于检测酶的活性 [14, 15] 。酶支配着生物体内的新陈代谢、营养和能量
转换等许多催化过程，影响着生物体内许多信号转导过程。Cheppali 等利用单分子三色
FRET 监测 NSF 酶解聚 SNARE 复合体的过程，揭示其解聚存在两条路径，澄清了酶作
用的中间状态机制 [16] 。樊林玮等通过 FRET 传感器发现机械牵张激活 cPLA2，抑制脂
肪酸氧化酶活性，通过调控转录因子 YY1 影响血管平滑肌细胞功能 [17] 。
在疾病诊断方面，FRET 技术在药物疗效评估等方面同样具有重要意义 [18, 19] 。2014
年，Bozza 等人通过设计特定的 FRET 生物传感器，能够直接反映癌症药物诱导癌细胞
凋亡的效果，为药物的研发和筛选提供了有力的工具，避免了因无法区分细胞死亡和
生长抑制而导致的结果偏差 [20] 。
FRET 定量分析方法的发展，如 33 -FRET（Three-cube-FRET）、E-FRET（EmissionFRET）和 FRET 双杂交分析等，帮助研究人员从独特的角度研究细胞内蛋白质等大分
子的相互作用。2016 年，Ben-Johny 等人利用 FRTE 双杂交分析技术定量研究了钙离子
通道与钙调蛋白之间的结合，发现当细胞内钙离子浓度较低时，一个钙调蛋白与一个
钙离子通道结合；当细胞内钙离子浓度较高时，一个钙离子通道可以同时结合两个钙
调蛋白 [21] 。杨方方等人利用 FRET 双杂交实验，研究了 Bcl-2 家族的四种抗凋亡或促
凋亡蛋白（即 Bcl-xL、Bad、Bax 和 tBid）在健康细胞和凋亡细胞中的相互作用。[22] 。

第3页

华南师范大学硕士学位论文

李小梅等人使用双杂交 FRET 成像等技术对 L 型钙通道 C 末端编码肽进行了定量研究，
证明了 Calmudolin 的多种变体均通过与钙调素竞争，抑制钙通道的基本功能 [23] 。

1.1.3

基于受体敏化发射的 FRET 定量测量方法（E-FRET）

受限于实验仪器和样本的准备，早期的 FRET 测量方式都只能基于定性或半定量
测量 [24, 25] 。复杂实验条件的校正，需要使用表达特定荧光蛋白的细胞进行校正，而蛋
白质在细胞中的表达又受到表达的成熟度、胞内的微环境等多种因素制约 [26] 。
基于受体敏化发射的通道方法（E-FRET）具有测量速度快、无损伤的特性，被公
认是最适合用于活细胞动态监测的 FRET 半定量检测技术 [27] 。E-FRET 方法需要对实
验系统响应和荧光团的光学性质进行严格的校准，一般通过提前测量多个参照样本，然
后保持在整个实验过程中系统的稳定和实验条件的一致。E-FRET 方法需要 3 个 Cube
组成的 3 个通道，分别实现供体激发供体收集（DD 通道）、供体激发受体收集（DA 通
道）和受体激发受体收集（AA 通道）。受体的敏化荧光从 DA 通道测得（IDA 图像），
但实际上 IDA 图像包含有受体的敏化荧光、直接激发受体的荧光和供体的发射荧光这 3
个部分。为了消除后两部分串扰是 FRET 指标不依赖于荧光强度，额外的 2 个通道的光
图像 IAA 和 IDD 需要收集。通过减掉串扰得到敏化荧光 FC ，由如下公式得到:
FC “ IDA ´ apIAA ´ cIDD q ´ dpIDD ´ bIAA q.

(1.5)

其中 a, b, c, d 是串扰系数，由单转的供体样本和单转的受体样本得到，其计算公式如下：
IDA pAq
,
IAA pAq
IDD pAq
b“
,
IAA pAq
IAA pDq
,
c“
IDD pDq
IDA pDq
.
d“
IDD pDq
a“

(1.6)
(1.7)
(1.8)
(1.9)

其中，IDA pAq 表示单转受体（A）样本在 DA 通道测得的荧光强度，其他参量意义类似。

第4页

FRET 双杂交分析数据处理软件的设计与开发

E-FRET 还需要测量得到荧光强度由 DD 通道转换为 DA 通道的转换因子 G，在仪
器系统参数保持不变时，G 因子可以通过敏化发射荧光 FC 在受体光漂白后荧光减少与
受体光漂白后供体在 DD 通道的荧光恢复的比值确定，其定义如下：

G“

FC ´ FCpost
post
IDD
´ IDD

.

(1.10)

post
post
其中 IDD
是受体光漂白后受体敏化发射的荧光强度，IDD
是受体光漂白后供体的荧光

强度。获得敏化淬灭转化因子 G 和敏化发射荧光强度 FC 后，供体角度的 FRET 效率
E D 可以通过如下公式计算：

ED “

FC
.
FC ` G ¨ IDD

(1.11)

为了确定待测样本中受体与供体的浓度比例，需要首先通过测量受体与供体比例
为 1:1 的 FRET 固定质粒样本来确定发生 FRET 时相等浓度的供体荧光和受体荧光的比
例 [28] ：

k“

IDD ` FC {G
.
IAA

(1.12)

然后使用 k 测量待测样本中的受供体浓度比 RC ，计算方式为：

RC “

rAs
k ¨ IAA
“
.
rDs
IDD ` FC {G

(1.13)

FRET 双杂交分析

1.2
1.2.1

基于 Langmiur 模型曲线拟合的 FRET 双杂交分析（L-FRET）

蛋白质之间相互作用的化学计量比是阐明蛋白质间相互作用机制的重要参数，确
定化学计量比能够进一步评估蛋白质间的生物相关性，并且能够确定其病理角色 [29, 30] 。
传统的体外生化方法往往都需要从细胞中分离并且提纯大分子复合物才能进行测量，
这类体外实验方法无法在活细胞中获得结果，而且一些大分子的复合物不容易进行分

第5页

华南师范大学硕士学位论文

离提纯或者体外重建，这就限制了这些体外方法的应用 [31] 。
FRET 过程改变了供受体复合物荧光发射谱的两个方面：（1）供体荧光淬灭；（2）
受体荧光增强。从这两个方面出发，FRET 效率也可以从两种方式进行测量：（1）通过
E-FRET 方法从供体角度测量的 FRET 效率 E D ，即供体转移给受体的能量占供体总能
量的比例；（2）通过 33 -FRET 方法从受体角度测量的 FRET 效率 E A ，即受体敏化发射
的荧光量占所有供体能量转移给受体时受体的荧光发射总量的比例。33 -FRET 方法中，
E A 可由如下公式给出：

EA “

FC ε A
,
a ¨ IAA εD

(1.14)

其中，εA {εD 是受体和供体的摩尔消光系数之比，a 是光谱串扰系数，由公式 1.6 确定。
FRET 双杂交分析是目前唯一可以在活细胞内进行生物大分子结合“滴定”实验
的技术。FRET 双杂交分析实验中，通过不断增加受体的浓度使得每个供体都结合有
受体，从而测出饱和结合时供体角度探测的最大 E D （E D,max ）。同样的方法，通过不
断增加供体的浓度使得每个受体都结合有供体，从而测出饱和结合时受体角度探测的
最大 E A （E A,max ）。在存在自由供体、自由受体和以 nD : nA 比例结合的受供体复合物
（nD D-nA A，nD 和 nA 是供体和受体在复合物中的数量），当所有供体都被受体结合时，
每个供体预期的能量转移效率为

E D,max

nD ÿ
nA
1 ÿ
“
Ei j .
n D i“1 j“1

(1.15)

当所有受体都被供体结合时，每个受体预期的能量转移效率为

E A,max

nA
nD ÿ
1 ÿ
Ei j .
“
nA i“1 j“1

(1.16)

于是，E A,max 与 E D,max 的比值即为供受体的化学计量比：
υ“

E A,max
nD
“
.
nA
E D,max

(1.17)

2016 年，Butz 等人提出将 FRET 效率和自由受供体浓度按照 Langmiur 模型进行拟
第6页

FRET 双杂交分析数据处理软件的设计与开发

合的 FRET 双杂交分析方法 [32] 。对于包含自由供体、自由受体和供受体复合物中，E D
和 E A 可分别与自由受体浓度、自由供体浓度相关联：
D f ree
,
D f ree ` Kd,EFF
A f ree
E D “ E D,max
,
A f ree ` Kd,EFF
E A “ E A,max

(1.18)
(1.19)

其中，Kd,EFF 为相对解离常数，D f ree 是自由供体的浓度，A f ree 是自由受体的浓度。从
公式 1.18 和公式 1.19 可以看出，与体外滴定实验类似，用 33 -FRET 法可得到 E A 随自
由供体浓度变化的动态滴定曲线，并得到 E A,max ，用 E-FRET 方法也可以得到 E D 随自
由受体浓度的动态滴定曲线，并得到 E D,max 。供受体复合物的化学计量比计算与公式
1.17 相同。

1.2.2

基于 FRET 效率 E D 和受供体浓度比 RC 线性分离的 FRET 双杂交分
析（DC-FRET）

L-FRET 方法存在一定的局限性。从实验条件上来看，L-FRET 需要得到 FRET 效
率与自由供体 / 自由受体间的饱和滴定曲线，这意味着实验人员需要精心准备不同供受
体浓度比的样本，并且这些样本的供受体浓度分布要尽可能均匀。因此 L-FRET 往往需
要配备一系列梯度比例的供体和受体溶液，然后分别对其进行混合和检测，这增加了
实验样本的数量。在实验数据处理时，大量浓度梯度都需要进行测量和数据处理，这极
大地增加了实验人员的工作量和操作难度。另一方面，从公式 1.18 和 1.19 来看，A f ree
和 D f ree 是拟合过程中更新的中间量，在实际的计算分析过程中，由于这些中间量的不
确定性以及数据的复杂性，很容易出现拟合失败的情况。一旦拟合失败，就需要重新进
行实验或者调整参数，进一步增加了实验成本。
为了解决这些问题，在 2018 年，杜孟艳等人创新性地发展了基于 FRET 效率（E D ）
和受供体浓度比（RC ）线性分离的 FRET 双杂交分析方法，简称为 Du-Chen-FRET
（DC-FRET）[33] 。DC-FRET 聚焦关注分析供体饱和结合和受体饱和结合的数据。当供

第7页

华南师范大学硕士学位论文

体完全饱和时，即 D f ree ąą Kd ，此时受体被完全结合，以下公式成立：
E A “ E A,max ,

(1.20)

E D “ E A,max ¨RC .

(1.21)

此时 E D 与 RC 成正比，且斜率为 E A,max 。当受体饱和时，即 A f ree ąą Kd ，此时供体被
完全结合，以下公式成立：
E D “ E D,max ,

(1.22)

E A “ E D,max ¨1{RC .

(1.23)

此时 E D 与 RC 成正比，且斜率为 E A,max 。求得 E A,max 和 E A,max 后，供受体复合物中的
化学计量比计算同公式 1.17 。
DC-FRET 方法相比 L-FRET 方法有着显著的优势。L-FRET 由于数据来源的不确定
性以及拟合过程的复杂性，可能会导致拟合结果的偏差较大。在 DC-FRET 方法中，实
验人员只需要准备 RC 比较大的样本和 RC 比较小的样本即可，无需像 L-FRET 那样准
备处于中间分布的大量样本。这样的样本选择方式极大地简化了实验流程，减少了样
本的制备和处理时间，从而大大减少了实验人员的工作量。在 DC-FRET 中，用于线性
拟合的 E D 和 RC 数据是由 E-FRET 方法定量测量得到的。E-FRET 方法具有较高的准确
性和稳定性，能够提供可靠的数据，通过这种方式得到的数据进行线性拟合，其结果也
更加稳定可靠。

FRET 分析数据处理方法现状

1.3
1.3.1

FRET 双杂交分析数据处理现状

FRET 双杂交数据处理流程复杂耗时，人工依赖程度高，严重制约了实验效率与数
据可重复性。
Butz 等指出，数据处理包括图像分析、FRET 定量计算及双杂交分析等多个环节，
共 28 个步骤，单次实验数据处理过程需要 3.5-7 小时不等 [32] 。在图像分析环节，科研
第8页

FRET 双杂交分析数据处理软件的设计与开发

人员需手动标注上百个典型荧光区域作为 ROI，逐一定量灰度值并计算荧光信号与背
景值，这一过程通常耗时 1-3 小时。在 FRET 定量计算阶段，研究人员需将标注三通道
荧光强度数据，再通过 Excel 设定公式完成批量计算，包括敏化发射荧光和 FRET 效率
等参数。这一过程虽部分实现自动化，但仍需人工输入数据并验证公式逻辑，耗时约
30 分钟至 1 小时。在双杂交拟合计算中，使用 Excel 规划求解拟合 Langmuir 模型需经
历 14 个步骤，耗时约 30 分钟。
通用软件缺乏针对 FRET 双杂交的优化。Zen 和 ImageJ 等通用软件可以手动标注
ROI，但是缺少直观的辅助信息如信号背景比等，更无法展示 FRET 效率等直观的结果。
Excel 的规划求解功能在处理非线性拟合时灵活性不足，常需结合编程工具进行二次开
发，频繁在 Excel 与 Matlab / Python 等工具间转移数据。
传统数据处理流程对科研人员的技术要求较高，不利于实验结果的复现和对比。
FRET 图像处理中，人工标记 ROI 是一种盲处理，此类人工操作不仅效率低下，还因缺
乏标准化操作规范，易引入主观偏差，影响数据的可复现性。在面对动态荧光事件或低
信噪比数据时，人工分析的主观性与低效性尤为突出 [34] 。
这些挑战促使科研人员探索更高效的自动化解决方案，以推动 FRET 技术在生物
医学研究中的广泛应用。

1.3.2

基于机器学习的 FRET 数据处理

近年来，随着机器学习不断发展，越来越多的研究者着手将此类方法应用于 FRET
数据分析。
深度学习技术为高效解析 FRET 技术中高效解析动态轨迹数据提供了新方法。Li 等
基于 LSTM 和 CNN 的 AutoSiM 框架，自动分类和分割单分子荧光轨迹，提升 SiMREPS
检测灵敏度与 smFRET 分析效率，支持迁移学习适应新数据 [35] 。Zhang 等人提出基于
LSTM 的 Kin-SiM 框架通过预训练模拟数据自动识别 smFRET 轨迹中的分子状态及动
力学参数，实现轨迹理想化，性能与传统 HMM 相当但效率更高，支持多任务学习适应
不同状态数 [36] 。Miao 等提出基于深度学习的局部特征分类框架 DEBRIS 和多帧双通道

第9页

华南师范大学硕士学位论文

融合去噪网络（MUFFLE），通过滑动窗口技术和用户自定义标准，自动识别双色 / 单
色单分子荧光事件。
应用深度学习技术提取 FRET 荧光信号，避免了重复的人工数据处理，提高了处理
效率。U-Net 模型是图像分割领域广泛运用的卷积神经网络架构，它能够有效捕捉荧光
图像的特征，精准地提取 ROIs 的荧光强度信息 [37] 。Ge 等人研发出一种基于 U-Net 模
型的深度学习方法进行高效 FRET 分析，该模型基于一个包含 230 个手动标注 ROI 的数
据集进行训练，随后通过旋转操作将数据集扩充，最终得到 2760 个样本 [38] 。Thomsen
等人开发的 DeepFRET 软件基于深度学习技术，实现了从原始显微镜图像到 FRET 数
据分类的全自动化流程 [39] 。该软件通过预训练的深度神经网络对荧光轨迹进行逐帧分
类，仅需用户设定质量阈值，即可快速生成高质量的 FRET 直方图。Feldmann 等在进
行 FRET 双杂交分析数据处理时采用了 ilastik 这一用于生物医学图像分析的开源交互
式工具，将机器学习算法与用户交互相结合，能减轻手动标注的工作量 [40] 。
然而，机器学习驱动的 FRET 图像分析算法仍存在一定局限性。首先，模型训练和
泛化的效果依赖优质的数据集，而 FRET 图像的手动标注需专业知识且耗时费力，导致
优质数据稀缺 [41] 。其次，深度人工神经网络模型的训练需要高性能图形处理器，伴随
较长的训练时间，数据集越大，训练占用的时间可能会越久 [42, 43] 。此外，深度学习模
型的“黑箱”特性使其缺乏可解释性 [44, 45] 。就基于强度的 FRET 定量分析而言，神经
网络虽然能够捕捉图像的细微特征，但却无法用清晰的数学框架来解释决策逻辑，而
且可能会引入未知的偏差。

1.4

本文的工作内容和意义
针对活细胞 FRET 双杂交分析数据处理流程繁琐、人工操作依赖性强等核心问题，

本文从以下方面开展了工作：
（1）首次设计并实现了支持多模态分析的 FRET 双杂交数据处理软件 Fretha。该软
件基于分层架构构建，集成成像参数设置、数据校验、自动 ROI 选取、FRET 定量计算
及双杂交拟合等核心功能。通过封装 FRET 计算器、图像处理器和双杂交求解器，实现

第 10 页

FRET 双杂交分析数据处理软件的设计与开发

了从原始图像到化学计量比结果的全流程自动化处理。软件采用 Qt 5.15.2 开发，支持
跨平台部署，并通过 OpenCV 和 dlib 库实现图像处理与优化计算，确保算法的高效性
和可扩展性 [46–48] 。通过一键式数据流转的软件功能设计，实现了从原始图像到化学计
量比结果的规范化处理，提升了数据处理效率。专门针对 FRET 双杂交分析设计的数据
处理软件，将有效降低 FRET 双杂交分析技术的使用门槛，规范化数据处理流程，提高
实验结果的可对比性和可重复性。
（2）对 Fretha 软件进行了系统的测试验证。标准质粒和模型质粒的实验的测量结果
接近文献报道的结果，验证了使用 Fretha 进行数据处理的准确性。针对每个功能模块，
单独进行了测试以确认每个模块的功能效果，保证了软件运行时符合设计预期。可靠
性测试显示，软件在 48 小时连续运行和高频操作下保持稳定，资源占用无显著波动。
综合测试结果表明，Fretha 软件在数据处理准确性和可靠性方面均达到预期，支持连续
规范化的数据处理，降低了 FRET 双杂交分析技术的数据处理门槛。
（3） 首 次 提 出 了 基 于 明 度 和 均 匀 度 的 自 动 ROI 选 取 算 法 LURS（LuminanceUniformity-based ROI Selection, LURS）算法，实现了自动 FRET 双杂交分析，提高了
FRET 双杂交技术的大规模数据处理能力。LURS 算法通过多通道自适应阈值分割、变
异系数均匀性评估和连通区域分析，实现了荧光图像中高信噪比区域的精准识别，显
著减少了人工标注 ROI 的时间成本。结合 LURS 算法和鲁棒性较好的 DC-FRET 方法，
Fretha 软件实现了 FRET 双杂交分析的数据处理全自动化。通过对比深度学习的方法，
本文验证了 LURS 自动处理在性能上优于 ilastik 和 SAM-Med2D，更适用于大数据量场
景。基于 LURS 算法的自动 FRET 双杂交分析为高通量药物筛选等大规模数据处理需
求提供了高效可靠的算法工具。

1.5

本文的章节安排
第一章，绪论。本章简要概述了定量 FRET 技术和 FRET 双杂交分析技术的理论基

础和发展，然后介绍了 FRET 数据分析处理方法的研究现状。同时介绍了本文的工作内
容和结构安排。

第 11 页

华南师范大学硕士学位论文

第二章，FRET 双杂交分析数据处理软件的设计和开发。本章基于 FRET 双杂交分
析数据处理流程和 FRET 多模态显微成像系统的特点进行需求分析，然后设计了 Fretha
软件的总体架构和模块划分，并详细介绍了各个模块的开发实现。
第三章，Fretha 的验证和测试。本章验证了使用 Fretha 进行 33 -FRET 和 E-FRET 分
析测量结果的准确性和稳定性，以及进行 FRET 双杂交分析数据处理的准确性。针对每
个模块，本章进行了单独的功能测试和性能测试，验证了 Fretha 软件的功能和性能符
合预期。最后，本章实施了 Fretha 稳定性测试，以测试 Fretha 长时间运行和高频操作
下的稳定性。
第四章，基于 LURS 的自动 FRET 双杂交分析。本章分析了 FRET 双杂交分析时的
痛点，提出了基于明度和均匀度的自动 ROI 选择算法，并结合 DC-FRET 方法实现了全
自动的 FRET 双杂交分析数据处理算法，在标准质粒和模型质粒上进行了验证实验。然
后，本文还应用自动化数据处理算法分析了加药处理前后的 Bcl-xL-Bak 在活细胞内的
相互作用，对比了深度学习方法的计算性能指标。
第五章，总结与展望。本章总结了本文的工作内容和在相关领域的意义，对后续研
究内容和方法进行展望。

第 12 页

FRET 双杂交分析数据处理软件的设计与开发

2

Fretha 的设计和开发

引言

2.1

FRET 双杂交分析是检测生物分子间相互作用的关键技术，是揭示生物过程分子机
制的重要工具。然而，传统的 FRET 双杂交分析数据处理过程繁琐且效率低下，严重依
赖人工操作，容易引入误差。开发专门针对 FRET 双杂交分析数据处理的配套软件，能
够实现数据的自动化采集、标准化处理以及高效的分析统计，对于提升研究效率和准
确性具有重要意义。
本章节介绍了展示 Fretha 软件从设计构思到开发实现的全过程。首先，根据课题组
自研的 FRET 显微成像系统（FRETScope）的数据特征和 FRET 双杂交分析数据处理功
能进行深入的需求分析，确定了主要的数据处理流程。基于此需求分析，对软件按照功
能进行的模块划分和总体框架设计。基于 dlib 和 OpenCV 等，设计了 FRET 定量计算
器、FRET 图像处理器和 FRET 双杂交求解器等后台接口，封装了 E-FRET、33 -FRET、
L-FRET 和 DC-FRET 等多模态分析算法。最后，结合 Qt 的图形化界面和 C++ 的高性
能计算能力，详细介绍各个功能模块的具体功能和实现方法。

需求分析和总体设计

2.2
2.2.1

需求分析

FRETScope 是本课题组自研的适用于 33 -FRET、E-FRET、Pb-FRET（PhotobleachingFRET）等多种定量 FRET 分析方法的 FRET 多模态显微成像系统。该系统具备高分辨
率成像、多通道同步采集等先进特性，能够获取高质量的 FRET 三通道图像数据。
使用 FRETScope 对制备好的样本进行图像采集得到若干视野的 FRET 三通道图像
后，通过 FRET 双杂交分析方法定量计算细胞中的生物大分子结合作用的 FRET 饱和效
率、化学计量比、相对亲和力等信息。FRET 双杂交分析的数据处理需要如下步骤：首
先需要对 FRET 数据进行数据完整性校验，确保每个视野下存在完整的三通道图像和文
第 13 页

华南师范大学硕士学位论文

图 2.1 FRETScope 硬件外观示意图
件完整可读，然后对每个视野进行荧光信号提取，通过在图像上绘制 ROI 并计算其灰
度均值作为 FRET 分析计算重要的荧光信号；根据 E-FRET 和 33 -FRET 方法将上述荧光
信号代入对应的计算公式求取 E A 、E D 、RC 等 FRET 数据；对这些数据进一步依据物理
含义或者数据分析进行异常值去除等数据预处理；最后是通过优化算法拟合 Langmiur
模型或者线性模型计算相关的参数。具体流程如图 2.2 所示。

2.2.2

模块划分和界面设计

结合 FRET 双杂交分析的数据处理流程与功能逻辑，Fretha 软件主要划分为以下核
心模块：
(1) 成像参数设置模块：负责设置 FRET 成像过程中的关键参数，确保成像数据的准
确性和一致性。该模块允许用户输入和保存成像参数，如曝光时间、光学参数等，
并提供参数校验功能，确保输入的参数在合理范围内，避免因参数设置错误导致
的数据分析问题。成像参数一般比较稳定，通常 2 到 3 个月才需要重新测量，因此
需要持久化到本地，以供多次处理数据时使用。
(2) 数据检验模块：对输入数据进行严格的完整性和合法性检验，避免异常数据导致
的分析错误。该模块会检查每个视野的三通道图像文件是否完整，并对文件格式
第 14 页

FRET 双杂交分析数据处理软件的设计与开发

图 2.2 FRET 双杂交分析数据处理流程
和内容进行验证，确保数据的可靠性。通过数据完备性检验，可以避免异常数据导
致的分析错误，提高数据处理的准确性。
(3) FRET 图像处理模块：支持手动图像处理和 ROI 选取，满足用户对数据的精细化
处理需求。用户可以在图像上手动圈选感兴趣区域（ROI），并进行图像增强、滤
波等处理操作。该模块提供多种图像处理工具，帮助用户提高图像质量和分析
精度。手动选取感兴趣区域 ROI 是一个基础且关键的操作，它能帮助分析人员
聚焦于细胞中荧光质量较高的区域，进行更精确的数据处理与分析。结合 LURS
（Luminance-Uniformity-based ROI Selection）算法实现自动 ROI 选取，减少人工操
作，提高处理速度和一致性。
(4) 数据管理模块：数据处理模块用于增删数据、筛选数据、导入导出、开始计算等功
能，还可以根据记录表中的数据项在 FRET 图像处理模块定位所选数据的 ROI。该
模块作为 FRET 图像处理模块和结果可视化模块的桥梁，负责数据的统一管理和
第 15 页

华南师范大学硕士学位论文

高效传递。
(5) 结果可视化模块：将分析结果以直观的图表形式展示，并提供数据保存功能，方
便用户进一步分析和应用。该模块支持多种图表类型，如趋势线图、散点图等，用
户可以根据需要选择 FRET 双杂交分析方法的对应视图，进行数据展示和分析。通
过结果可视化，用户可以更直观地理解分析结果，比如分析 FRET 双杂交分析计算
拟合程度等，以确认数据分析的结果。结果可视化模块还可以将分析结果保存为
图片或数据文件，方便用户进行后续数据处理和报告撰写。
在界面设计上，根据软件使用需求和模块功能，主要分为：开始页、参数设置页、
数据处理页、结果页。在软件开始页提供了跳转参数设置页或数据处理页的按钮，如图
2.3 所示；参数设置页面包括成像参数设置模块，其界面如图 2.4 所示；数据处理页包

图 2.3 Fretha 开始页界面
括数据检验模块的检验结果、FRET 图像处理模块、数据管理模块，其界面和模块划分
如图 2.5 所示；结果页展示结果可视化模块中 FRET 双杂交数据处理的图像视图结果，
界面如图 2.6 所示。

2.2.3

软件总体框架

Fretha 架构采用分层设计，由顶层向下依次分别为：表现层、业务层、数据访问层
和数据层，如图 2.7 所示。
第 16 页

FRET 双杂交分析数据处理软件的设计与开发

图 2.4 Fretha 参数设置页界面

图 2.5 Fretha 数据处理页界面及模块划分
表现层（Presentation Layer）处于整个架构的最外层，直接面向用户，是用户与系
统进行交互的主要界面。它负责接收用户输入的各种指令和数据，并以直观、友好的方
式展示系统的处理结果。Fretha 的表现层主要包括开始界面、参数设置界面、FRET 图
像处理界面、结果可视化界面等，用户能够通过表现层的软件界面与系统进行交互，完
成 FRET 双杂交分析的数据处理操作。
业务层（Business Logic Layer）是整个架构的核心逻辑处理部分，承担着具体模块
功能和其对应的业务逻辑的实现。业务层接收来自表现层的请求，根据预设的业务逻
第 17 页

华南师范大学硕士学位论文

图 2.6 Fretha 结果可视化模块界面

图 2.7 Fretha 软件总体架构
辑对数据进行处理和转换。Fretha 的业务层封装了包括参数读 / 写业务、数据检验业务、
自动 ROI 选取业务、数据导入 / 导出业务、FRET 双杂交分析业务、可视化绘图业务等。
数据访问层（Data Access Layer）实现对数据的访问和操作，它将业务层与数据层
进行隔离。数据访问层提供了统一的数据访问接口，业务层通过调用这些接口来获取
和存储数据，而无需关心数据的具体存储方式和位置。通过设置数据访问层，能够使
第 18 页

FRET 双杂交分析数据处理软件的设计与开发

得在复杂的业务处理时避免对数据的直接操作和影响，从而提高了数据存储的安全性。
Fretha 的数据访问层包括 FRET 图像数据访问、FRET 数值数据访问和 FRET 双杂交数
据访问的接口。特别地，在数据访问层还包括 FRET 定量计算器和 FRET 图像处理器、
FRET 双杂交求解器等，它们除了可以作为数据访问层的接口，还可以完成 FRET 计算
分析作为业务层的业务逻辑处理单元，这样的设计减少了业务层设计的复杂度，提高
了系统的可维护性和可扩展性。
最后是数据层（Data Layer），作为架构的最底层，数据层负责存储系统的所有数
据。Fretha 数据层包括系统静态数据、FretImage 模型、FretDataPiece 模型和 FretRecord
模型。系统静态数据是在软件运行时的环境参数，只需要在指定步骤运行前提前设置
好即可，如成像参数、文件目录等。FretImage、FretDataPiece 和 FretRecord 用来存储和
计算各种动态数据。在 FRET 双杂交分析数据处理中，一组 FRET 三通道图像中可以
提取并计算出若干条 FRET 数据，由若干条 FRET 数据作为一个批次只能解析出一条
FRET 双杂交分析结果。因此，在设计上三种数据实体类型存在关联关系，FretImage
和 FretDataPiece 之间存在一对多的关系，FretDataPiece 和 FretRecord 之间存在一对多
关系，如图 2.8 所示。

图 2.8 Fretha 数据层实体关联关系图

2.2.4

开发技术选型

Qt 是目前最流行的跨平台应用程序开发框架之一，广泛应用于桌面、嵌入式和移
动设备等领域。Qt 5.15.2 是 Qt 官方发布的长期支持（LTS）版本，具有卓越的跨平台性
能。Qt 通过信号和槽机制实现了高效的事件驱动编程，能够轻松处理用户输入、定时
器事件和其他异步事件。在 UI 构建和实现上，Qt 提供了丰富的原生控件库。开发者可
第 19 页

华南师范大学硕士学位论文

以通过简单拖拽就能完成按钮、文本框等基础组件的布局，系统会自动生成适应不同
屏幕尺寸的代码。通过布局管理器，界面元素能像乐高积木一样灵活组合，既保证了跨
平台一致性，又大大提高了开发效率。因此，本文选择 Qt 作为 Fretha 的开发框架。
OpenCV（Open source computer vision library）是一个功能强大的跨平台开源工具，
支持在 Windows、Linux、macOS、Android、iOS 等多种操作系统上部署。它涵盖了图
像处理与视频分析的核心功能，包括图像加载、滤波处理、边缘检测等基础操作。该库
借助 SIMD 优化和多线程并行计算技术，显著提升了处理效率，能够满足实时性任务
需求。社区还提供了大量算法示例、代码模板和行业应用案例，为开发者提供了完善的
学习资源和技术支持。鉴于这些优势，OpenCV 被选为 Fretha 图像处理模块的核心技术
方案。
在 Fretha 的双杂交拟合过程中，本文采用 C++ 库 dlib 来处理优化计算任务。dlib
整合了梯度优化算法与自适应学习率策略，在保证收敛速度的同时减少了陷入局部最
优的风险。算法实现上，dlib 结合了牛顿法和类牛顿方法，这种组合既保留了牛顿法的
高精度特性，又通过拟牛顿近似提升了计算效率。在约束优化问题上，还支持通过内点
法解决资源分配中的约束问题。

FRET 算法和后台接口

2.3
2.3.1

FRET 定量计算器

FRET 定量计算器（FretCalculator）用于处理 E-FRET 和 33 -FRET 定量计算。如图
2.9 FRET 定量计算器定义了参数设置、数据加载、数据校正、数据计算和结果获取等
计算步骤，每个步骤需要按照顺序执行，并且在执行时记录运行状态，在获取结果数据
之前进行检查来保证数据安全。
参数设置中，FretCalculator 读取系统静态数据中的成像参数，用于在计算中使用。
通过接口函数加载 IDD 、IDA 、IAA 数据到 FretCalculator 实例的数据成员中，然后数据校
正中，FretCalculator 对 FRET 图像数据进行背景值估计和荧光强度校正，并按照曝光时
间进行归一化。校正后的数据根据 E-FRET 和 33 -FRET 方法对荧光强度进行计算，得
第 20 页

FRET 双杂交分析数据处理软件的设计与开发

图 2.9 FretCalculator 计算步骤

到 FRET 定量计算结果 E D 和 RC 等。最后，通过指定结果名，FretCalculator 可以返回
给调用者。

2.3.2

FRET 图像处理器

FRET 图像处理器（FretImageProcesser）封装了对 FRET 图像进行计算分析的计算
器类，FRET 图像处理器的计算类 FretImageProcesser 的计算步骤和 FRET 定量计算器
类似，如图 2.9 所示。FretImageProcesser 处理的数据类型和返回的数据是 OpenCV 的
Mat 数据结构，可以方便地存储和处理图像数据和逐像素的 FRET 图像数据。FRET 图
像分析时需要对每个像素点的荧光强度进行计算，对图像数据进行遍历处理。
此外，FRET 图像处理器以静态方法的形式提供了 FRET 图像处理时涉及的一系列
算法接口，包括图像预处理、图像分割、特征提取、图像增强等。所有的算法接口如表
2.1 所示。运用这些算法，FRET 图像处理器支持了对 16 位原始数据的计算处理能力，
以及可视化输出为伪彩图等功能。
第 21 页

华南师范大学硕士学位论文

表 2.1 FRET 图像处理库算法接口
接口

参数

说明

Mat: 二值化图像
morphologyClose

int: 迭代次数
Mat: 二值化图像

morphologyOpen

int: 迭代次数
Mat: 单通道图像

medianFilter

int: 核大小
Mat: 单通道图像

meanFilter

int: 核大小

形态学闭运算

形态学开运算

图像中值滤波

图像均值滤波

Mat: 单通道图像
gaussianFilter

int: 核大小

图像高斯平滑

double: 高斯标准差
getBackgroundValue

Mat: 单通道图像

基于直方图的背景值估计

otsuThreshold

Mat: 输入图像

Otsu 自动阈值分割

Mat: 输入图像
adaptiveThreshold

int: 邻域大小（奇数）

自适应局部阈值分割

double: 阈值偏移量
applyPseduoColor

Mat: 单通道图像（8 位）
Mat: 输入图像

applyMask
minMaxNormalization

Mat: 掩膜（二值 / 同尺寸）
Mat: 输入图像

伪彩色映射（Jet 颜色表）
图像掩膜操作
全局线性归一化

Mat: R 通道（8 位）
mergeChannels

Mat: G 通道（8 位）

多通道图像合并

Mat: B 通道（8 位）

2.3.3

FRET 双杂交求解器

FRET 双杂交求解器对采集到的 FRET 批数据 E D 、E A 、RC 、Aest 和 Dest 进行最优
化计算，以获取使预测结果与测量结果之间误差最小的 E A,max 、E D,max 、nD {nA 、Kd,EFF
等参数。求解器从数据模型 FretRecord 中获取批量数据作为数据集，然后分别按照
DC-FRET 方法或 L-FRET 方法进行 FRET 双杂交分析求解。DC-FRET 和 L-FRET 的双
杂交求解算法如下。
第 22 页

FRET 双杂交分析数据处理软件的设计与开发

（1）DC-FRET 线性拟合算法的封装。根据公式1.20和 1.22，DC-FRET 拟合斜率时
截距项为 0。以参数 E A,max 的拟合过程为例，其线性方程形式为
E D “ E A,max ¨ RC ,

(2.1)

其中，E D 是自变量，RC 是自变量，E A,max 是斜率。线性拟合的目标是找到合适的参数
E A,max ，使得方程预测的 E D 值与实际观测到的 E D 值之间的误差尽可能小。通常使用最
小二乘法，其原理是最小化观测值与预测值之间的误差平方和，即
n
ÿ
S “ pE Di ´ pE A,max RCi qq2

(2.2)

i“1

其中，n 是数据点的数量，RCi 和 E Di 分别是第 i 个数据点的自变量和因变量的值。为了
找到 S 最小的 E A,max 值，对 S 关于 E A,max 求偏导，并令其等于 0。首先，展开误差 S ：

S “

n
ÿ
2
2
pE D
´ 2E A,max RCi E Di ` E A,max
RC2 i q,
i

(2.3)

i“1
n

ÿ
BS
“ p´2RCi E Di ` 2E A,max RC2 i q,
B E A,max i“1

令

BS
B E A,max

(2.4)

“ 0：
n
ÿ
p´2RCi E Di ` 2E A,max RC2 i q “ 0,
i“1
n
ÿ

´2

RCi E Di ` 2E A,max

i“1

n
ÿ

RC2 i “ 0,

(2.5)
(2.6)

i“1

最后求解 E A,max ：
řn

E A,max “

RCi E Di
.
2
i“1 RCi

i“1
ř
n

(2.7)

公式 2.7 给出了线性拟合求解 E A,max 的解析公式，应用类似方法可直接计算斜率 E A,max
和 E D,max ，从而避免了基于迭代的线性拟合求解算法的消耗。
（2）L-FRET Langmiur 模型拟合算法的封装。Langmiur 模型具有模型的非线性和
参数的复杂性，无法通过简单的解析式解析其求解公式。本章通过引入 dlib 计算库进
第 23 页

华南师范大学硕士学位论文

行复杂的参数拟合。
为完成拟合计算，需要设计专门的数据类型 ColumnVector 和 ExperimentalData，如
代码 2.1所示。ColumnVector 类型用于存储双精度浮点数的列向量，在后续的计算和优
化过程中承载参数向量和中间计算结果。ExperimentalData 结构体用于存储来自实验采
集到的数据集，该结构体包含四个 std::vector<double> 类型的成员变量：aest 存储 Aest
相关的数据数组，dest 存储 Dest 相关的数据数组，ea_corr 存储 E A 预测值（E A,p ）与测
量值（E A,o ）之间的误差，ed_corr 存储 E D 预测值（E D,p ）与测量值（E D,o ）之间的误差。
代码 2.1
1
2

数据类型

// 定义列向量类型
typedef dlib::matrix<double, 0, 1> ColumnVector;

3
4
5
6
7
8
9
10

// 定义数据结构体，用于存储实验数据
struct ExperimentalData {
std::vector<double> aest;
std::vector<double> dest;
std::vector<double> ea_corr;
std::vector<double> ed_corr;
};

如 代 码 2.2 所 示，CalculateLoss 函 数 负 责 计 算 模 型 在 整 个 数 据 集 上 的 整 体 损 失。
CalculateLoss 函数首先遍历数据集中的每个数据点，对于每个给定的 ExperimentalData
实例和参数向量计算出 E A 或 E D 预测值和与实际值之间的误差，最后将误差累加到
total_error 中。
代码 2.2
1
2

3
4
5

6

7

8

误差计算函数

// 计算整体损失
double CalculateLoss(const ExperimentalData& data, const
ColumnVector& parameters) {
double total_error = 0.0;
for (size_t i = 0; i < data.aest.size(); ++i) {
double d_free = ((data.dest[i] - parameters(0) - data.aest[i]
* parameters(1)) + std::sqrt(std::pow(data.dest[i] parameters(0) - data.aest[i] * parameters(1), 2) + 4 *
parameters(0) * data.dest[i])) / 2;
double a_free = data.aest[i] - (data.dest[i] - d_free) /
parameters(1);
double ea_pred = parameters(2) * d_free / (d_free +
parameters(0));
double ed_pred = parameters(3) * a_free / (a_free +
parameters(0) / parameters(1));

9
10

total_error += CalculateError(data.ea_corr[i], ea_pred) +
CalculateError(data.ed_corr[i], ed_pred);
第 24 页

FRET 双杂交分析数据处理软件的设计与开发

}
return total_error;

11
12
13

}

TwoHybridSolver 是用来调用整个拟合过程的函数，并向外提供调用接口，如代码 2.3 所
示。TwoHybridSolver 函数接受四个 std::vector<double> 类型的参数，分别为 aest_data、
dest_data、ea_corr_data 和 ed_corr_data，返回一个 ColumnVector 类型的对象，其中存
储了经过拟合的结果参数。整个拟合过程如下：首先设置 Kd,EFF 、nD {nA 、E A,max 和
E D,max 的 拟 合 初 值 为 1、1、0.5 和 0.5， 存 储 到 ColumnVector 对 象 starting_point， 作
为 参 数 拟 合 的 起 始 点。 创 建 一 个 ExperimentalData 类 型 的 对 象 data， 将 传 入 的 四
个 实 验 数 据 向 量 存 储 在 该 结 构 体 中， 以 便 后 续 目 标 函 数 使 用。 使 用 dlib 库 中 的
find_min_using_approximate_derivatives 函数进行优化。在搜索策略算法上，求解器采用
一种拟牛顿法 dlib::bfgs_search_strategy() ，用于在参数空间中寻找目标函数的最小值，
并使用 dlib::objective_delta_stop_strategy(1e - 7) 作为停止策略，当两次拟合后参数的变
化小于 10´7 时，认为此时的结果已收敛，停止优化过程。最后，函数返回 starting_point，
此时 starting_point 存储的是经过优化后得到的拟合参数。
代码 2.3

双杂交求解器

1
2
3

4
5
6

// 双杂交求解器，进行参数拟合
ColumnVector TwoHybridSolver(const std::vector<double>& aest_data,
const std::vector<double>& dest_data, const std::vector<double
>& ea_corr_data,const std::vector<double>& ed_corr_data) {
// 初始化起始点
ColumnVector starting_point(4);
starting_point = 1, 1, 0.5, 0.5;

7
8
9

// 创建数据结构体
ExperimentalData data = {aest_data, dest_data, ea_corr_data,
ed_corr_data};

10
11
12

13
14

// 定义目标函数包装器
auto objective_wrapper = [&data](const ColumnVector& parameters
) {
return ObjectiveFunction(parameters, &data);
};

15
16
17

// 使用 dlib 进行优化
dlib::find_min_using_approximate_derivatives(dlib::
bfgs_search_strategy(), dlib::objective_delta_stop_strategy
(1e-7), objective_wrapper, starting_point, -1, 0.01);

18
19

return starting_point;
第 25 页

华南师范大学硕士学位论文
20

}

功能模块的实现

2.4

成像参数设置模块

2.4.1

FRET 定量分析中，在数据处理前需要设置好 FRET 定量计算过程中必须的参数，
设置成像过程时的成像参数至关重要。成像参数设置模块的界面如图 2.4 所示，包括了
FRET 成像参数的设置和保存功能。
FRET 成像参数在 Fretha 中以静态参数保存在软件内存中，是数据处理时的环境参
数。其中，a、b、c、d、G、k 和 Y 是 FRET 成像系统的光学参数，在前文中已介绍；
ExpTimeAA、ExpTimeDD 和 ExpTimeDA 是成像时三个探测通道的曝光时间，在 FRET
定量计算时需要根据曝光时间参数在各个通道归一化，然后才能进行计算。Fretha 中包
括的所有成像参数如表 2.2 所示。
表 2.2 FRET 成像参数
参数

说明

意义范围

a

供体激发时在 DA 通道的串扰系数

p0, 1q

无

b

所有的一切都在这里面。

p0, 1q

无

c

模板类文件。

p0, 1q

无

d

受体激发时在 DA 通道的串扰系数

p0, 1q

无

G

供体猝灭和受体荧光增强的比值

p0, `8q

无

k

受体浓度和供体浓度相同时的荧光比值

p0, `8q

无

p0, `8q

无

供受体在激发光条件下的消光系数之比，也记作
Y

εA {εY

单位

ExpTimeDD

DD 通道下的成像曝光时间

p0, `8q

毫秒（ms）

ExpTimeDA

DA 通道下的成像曝光时间

p0, `8q

毫秒（ms）

ExpTimeAA

AA 通道下的成像曝光时间

p0, `8q

毫秒（ms）

参数设置业务设计上遵循如下原则：
(1) 所有参数一同更新，避免因参数不匹配导致的数据处理错误；
(2) 每个参数需要在其有意义的范围内，避免无意义的值。
第 26 页

FRET 双杂交分析数据处理软件的设计与开发

FRET 成像参数是一批参数，参数间存在依赖关系，如测量参数 G、k、Y 就依赖参
数 a、b、c、d，这是因为测定参数 G、k、Y 时需要计算敏化发射荧光 FC ，根据公式 1.5
所示，FC 的确定与 a、b、c、d 密切相关。强制所有参数一同更新可以避免用户单独设
置某一参数而导致参数之间不匹配等问题。因此，在点击“更新参数”按钮时，若无法
从界面中的每个参数输入框都解析到合法的数字，那么本次更新参数就会失败。
FRET 成像参数一般比较稳定，一般 2 到 3 个月才需要重新测量，因此需要持久化
到本地，以供多次处理数据时使用。Fretha 的本地参数文件保存为可执行程序同级目录
下的“config.ini”中。在软件初始化阶段，会自动检测并应用本地配置文件中的参数。
用户可通过保存多套配置文件，在使用时替换目标配置文件，快速进行参数配置的切
换。
参数设置的主要业务流程如图 2.10 所示。

2.4.2

数据检验模块

FRET 双杂交分析需要处理一批 FRET 图像文件，因此需要对输入数据的完备性进
行检验识别。该模块的作用有以下两个方面：一方面通过模式识别 FRET 合法数据，避
免了异常输入导致的运行错误；另一方面，在这一模块会将 FRET 批数据的视野子文件
夹进行解析和类型识别，为后续数据处理提供对子文件夹的不同操作。
Fretha 的数据识别检验模块匹配识别 FRETscope 的数据格式，从而保证数据处理能
够正常开始。如图 2.11 所示，FRETscope 的数据结构由上层到下层依次为：
(1) 批数据根目录：存放所有视野子目录和数据文件；
(2) 视野子目录：存放一个视野的三通道图片和参数文件；
(3) 图片数据和参数文件。
数据检验业务的流程如图 2.12 所示。其中，检查子文件夹类型是通过图 2.11 进行
匹配的，当且仅当子文件夹中同时存在“DA.tif”、“DD.tif”和“AA.tif”图片文件时，
当前子文件夹会被识别为 FRET 视野，并在视野表格模型中记录。其他情况的子文件夹
会被记作“Unknown”文件夹，在后续 FRET 图像处理或者自动处理中被跳过。这种检

第 27 页

华南师范大学硕士学位论文

图 2.10

参数设置模块业务流程

查还会对图像数据是否可读进行检查。

2.4.3

FRET 图像处理模块

FRET 图像处理模块是对 FRET 三通道图像进行 ROI 标注等图像处理分析的模块，
其界面如图 2.13 所示：在 FRET 图像处理工作里，手动选取感兴趣区域 ROI 是一个基础
且关键的操作，它能帮助分析人员聚焦于特定区域，进行更精确的数据处理与分析。为
实现图像处理过程中 ROI 的手动选取功能，Fretha 借助 Qt 框架提供的 QGraphicsView
类，开发了自定义的 FretGraphicsView 类。QGraphicsView 是 Qt 用于可视化和交互处理
第 28 页

FRET 双杂交分析数据处理软件的设计与开发

图 2.11 FRETscope 数据文件结构

图 2.12 Fretha 数据检验业务主流程图

第 29 页

华南师范大学硕士学位论文

图 2.13 Fretha 图像处理模块界面
二维图形场景的重要类，具备丰富的功能和良好的可扩展性，为 FretGraphicsView 的实
现提供了有力支撑。
FretGraphicsView 类中设计了一个基于 QRectItem 的 ROI 成员，它能够在视图中直
观呈现 ROI 的大小和位置，方便用户确认所选区域。设定 ROI 的绘制模式为“Crop
Mode”截取模式时，此时会根据鼠标和 ROI 边框的位置，变换 ROI 交互的功能，包括
ROI 的创建、移动、缩放等操作。切换绘制模式为“Stamp”邮戳模式，此时可以固定
ROI 的大小，从而快速圈选多个大小一致的 ROI。
Fretha 的状态栏中提供了视图类型切换选项，在数据处理中可以辅助圈点，支持的
视图类型如表 2.3所示。归一化增强图包括 DD、DA、AA 通道分别归一化的增强视图
以及三通道归一化合成图。由于 FRET 成像系统的相机的量程为 r0, 65535s，计算机显
示渲染机制里显示会将 65535 的灰度值设为白色，而 0 的灰度值设为黑色，这样会导致
第 30 页

FRET 双杂交分析数据处理软件的设计与开发

表 2.3 FRET 图像视图类型表
信息

说明

Channel Merged

三通道归一合成图

DD Normalized

DD 通道的归一化增强图

DA Normalized

DA 通道的归一化增强图

AA Normalized

AA 通道的归一化增强图

RC Pseudo

RC 逐像素数值伪彩图

E D Pseudo

E D 逐像素数值伪彩图

图像的对比度不高，不利于观察。通过表 2.1 中的 minMaxNormalization 算法，可以对
图像进行全局线性归一化，从而增强图像的对比度。三通道归一化合并图则是将三个
通道的归一化增强图分别作为 RGB 色彩通道，合并成一幅彩色图像，以便于用户直观
地观察三通道的信号分布情况。增强视图的算法首先通过 FretImageProcessor 进行逐像
素 FRET 计算得到 E D 和 RC 的逐像素矩阵，然后归一化后赋予伪彩图。
Fretha 状态栏能够清晰展示当前视野及 ROI 的状态信息，如当前视野的三通道背
景灰度值、ROI 信号的三通道信号背景比等，还可以显示使用当前 ROI 提供的扣除背
景灰度值后的 IDD 、IDA 和 IDD ，其中所有显示内容如表 2.4所示。FretGraphicsView 通过
自定义鼠标释放事件的信号，实现了与数据访问层的数据交互。当用户完成 ROI 选取
并释放鼠标时，FretGraphicsView 会将 ROI 的坐标和大小信息传递给数据访问层。数据
访问层依据当前视野索引，从数据模型中读取相应的三通道图像文件，并且从 ROI 信
息提取 FRET 信号。在获得了 IDD 、IDA 和 IDD 后，Fretha 后台会自动扣除每个通道的背
景灰度，然后根据公式 1.5，调用后台的 FretCalculator 计算出敏化发射的荧光强度 FC 、
E D ，RC ，并显示在状态栏中，方便用户获取处理结果，为 ROI 的保留和移除提供判断
依据。这种基于 QGraphicsView 扩展的设计，有效提升了 ROI 选取的灵活性和准确性。

2.4.4

数据管理模块

数据管理模块支持对数据的实时操作，可以对于图像处理模块获得的数据，进行
异常数据筛选、数据追踪、数据导入、数据导出、计算入口等数据管理控制功能。
第 31 页

华南师范大学硕士学位论文

表 2.4 FRET 圈点状态栏显示内容
信息

说明

DD 通道信号

DD 通道的 ROI 内灰度均值

DA 通道信号

DA 通道的 ROI 内灰度均值

AA 通道信号

AA 通道的 ROI 内灰度均值

DD 通道背景

DD 通道的视野背景灰度值

DA 通道背景

DA 通道的视野背景灰度值

AA 通道背景

AA 通道的视野背景灰度值

DD 通道 SBR

DD 通道的信号背景比

DA 通道 SBR

DA 通道的信号背景比

AA 通道 SBR

AA 通道的信号背景比

FC

敏化发射的荧光强度

ED

供体视角的表观 FRET 效率

RC

受体与供体的浓度比

一条数据类型 FretDataPiece 中包含数据如表 2.5 所示。可以看出，FretDataPiece 包
含了一个 ROI 对应的所有原始信息，如 ROI 的位置、大小、信号强度、视野等；同时，
还包含了计算后的 E D 、E A 、RC 、1{RC 等中间参数，可以直接被用于后续的数据处理。
为保证数据符合实际物理意义，避免中间变量的异常值对后续计算产生影响，数
据管理模块提供了数据筛选功能。点击“筛选数据”，数据管理模块会对数据根据物理
定义和统计学准则进行筛选，剔除异常数据。具体数据筛选流程实施如下：
(1) 对 IDD 、IDA 、IAA 基于物理约束的初步数据清洗：针对各数值型变量 Xi ，依据其预
设的物理合理区间 rLi , Ui s 执行有效性校验。构建如下二元判别函数：

δp xi q “

$
’
’
’
& 1,

xi R rLi , Ui s

’
’
’
% 0,

xi P rLi , Ui s

(2.8)

当 δp xi q “ 1 时，判定该数据点为物理意义上的异常值并予以剔除。
(2) 对中间变量 E D 、E A 、RC 统计离群点检测：对经初步清洗后的数据子集 E D 、E A 和
第 32 页

FRET 双杂交分析数据处理软件的设计与开发

表 2.5

FretDataPiece 数据类型

信息

说明

IDD

ROI 在 DD 通道扣除背景后的信号强度

IDA

ROI 在 DA 通道扣除背景后的信号强度

IAA

ROI 在 DD 通道扣除背景后的信号强度

ED

根据 IDD 、IDA 、IAA 计算的 E D

RC

根据 IDD 、IDA 、IAA 计算的 RC

EA

根据 IDD 、IDA 、IAA 计算的 E A

1{RC

RC 的倒数

Aest

供体相对分子数的估计值

Dest

受体相对分子数的估计值

x

ROI 的横坐标

y

ROI 的纵坐标

w

ROI 的宽度

h

ROI 的高度

view

ROI 隶属的视野

RC ，分别计算变量的样本均值 µ 和样本标准差 σ，计算公式如下：
µ“

n
ÿ

1
xi ,
n i“1

g
f
n
f 1 ÿ
σ“ e
p xi ´ µq2
n ´ 1 i“1

(2.9)

采用 3σ 准则设定离群阈值，即构建判别区间 rµ ´ 3σ, µ ` 3σs。超出该区间的观测
值均判定为统计离群点并剔除。
数据导出用于保存数据处理时的 ROI 信息。在完成 FRET 图像处理和 ROI 绘制
选取后，需要保存 ROI 的结果，以便后续分析或者修改编辑。在数据管理模块点
击“导出数据”按钮，Fretha 将会导出数据区记录的所有数据，每一条数据都会按照
FretDataPiece 定义进行逐列导出，如表 2.5 所示，文件格式为 CSV 文件。数据导入功能
可以选择 CSV 文件，然后解析其中的数据按照 FretDataPiece 的格式。
点击“添加数据”按钮或者使用快捷键“A”，可以添加当前状态栏中的数据到数
据表格中；点击“删除数据”按钮或者使用快捷键“D”，可以删除数据表格中选中的
数据；点击“清空数据”按钮或者使用快捷键“C”，可以清空数据表格中的所有数据；
第 33 页

华南师范大学硕士学位论文

点击“开始计算”按钮，软件将调用 FretTwoHybridSolver 等算法对数据表格中的数据
进行 FRET 双杂交分析求解计算，并将结果显示在结果可视化模块中，然后切换软件界
面到结果可视化模块。
在数据表格中点击某一条数据，软件会根据这条数据的位置和形状信息，在图像
显示上显示该条数据对应的 ROI 位置，以方便检查数据处理中标注 ROI 的错误。实现
这一功能，主要基于 Qt 提供的信号与槽机制。将数据中的数据模型被点击的事件信号
与 FretGraphicsView 控件中的回调槽函数绑定后，FretGraphicView 模型可以接收到来
自所选数据的信息，并将当前活动的 ROI 按照所选数据项中 ROI 的 x、y、w 和 h 绘制
到 FretGraphicsView 控件上。接下来，FretGraphicsView 会将窗口的视角中心移动到所
选数据的 ROI 中心，以便用户更加直观地查看数据的位置和形状。

2.4.5

结果可视化模块

FRET 双杂交分析的输出结果包含双杂交计算的参数结果与拟合曲线图。其中，
E A,max 、E D,max 、nD {nA 、Kd,EFF 等参数以数据框形式展示；拟合曲线图通过将双杂交理
论拟合曲线与实验散点数据同图可视化，实现对拟合效果的直观评估，进而验证 FRET
双杂交分析结果的可靠性。
结果可视化模块的界面组成如图 2.6 所示，主要包含以下三个功能区域：
(1) 视图选择：切换 FRET 双杂交分析算法，更新对应的结果视图；
(2) 图表分析：显示 FRET 双杂交分析的拟合趋势线和散点图；
(3) 操作按钮：结果保存按钮和返回圈点界面按钮。
点击视图按钮可以切换不同 FRET 双杂交分析的算法方法的计算结果，更新图表分
析区域显示的方法。在可视化结果展示区域，软件将拟合结果与实验数据同步呈现在同
一坐标系中，便于用户进行直接比对。拟合曲线是基于拟合参数计算得到的理论数据点
连接而成的平滑曲线，实验数据则以离散点形式展示，用户可以直观检查拟合计算的效
果和误差大小。可视化界面基于 QChart 组件作图绘制，根据一批数据（FretDataRecord）
的数据范围分布，自动优化坐标轴刻度范围，以提升数据可视化的清晰度。

第 34 页

FRET 双杂交分析数据处理软件的设计与开发

在 L-FRET 视图模式下，软件集成了数据预处理 BIN 功能，允许用户通过设定 BIN
的上下限及间隔参数，对数据合并预处理的参数进行灵活调节，然后点击“更新”按钮
即可更新结果，在 L-FRET 计算效果不理想时可以用来优化数据处理结果。L-FRET 视
图界面在图 2.6 中展示。

图 2.14 Fretha DC-FRET 视图
DC-FRET 视图的界面如图 2.14 所示。在 DC-FRET 视图模式下，软件能显示出
DC-FRET 的拟合结果，包括 E A,max 、E D,max 、nD {nA ，以及拟合曲线和实验数据的对比
图。界面中设计了调整线性拟合参数的设置栏，用户可以调整 RC （1{RC ）的数据范围，
点击“更新”按钮以应用范围参数，用来处理复杂的数据。
点击“保存结果”按钮后，系统将同步存储拟合结果数据、可视化图像及实验数
据，保存结果如图表所示。其中，实验数据与拟合参数的原始数值将以 CSV 文件格式
进行保存，该文件包含可直接用于其他科研绘图软件的数据记录，从而支持用户在不
同可视化工具中进行后续的图形优化与再处理。这一功能设计保障了实验结果的完整
留存，为科研工作者提供了灵活的数据导出与再分析解决方案。

2.5

本章小结
本章系统阐述了 FRET 双杂交分析数据处理软件 Fretha 的设计框架与实现方法。通

过采用分层架构，Fretha 采用了表现层、业务层、数据访问层和数据层的四层架构体系
第 35 页

华南师范大学硕士学位论文

表 2.6

结果保存生成文件

文件名

说明

Ea-Rda 图.png

E A -1{RC 散点和趋势线图

Ed-Rad 图.png

E D -RC 散点和趋势线图

Ea-Dfree 图.png

E A -D f ree 散点和趋势线图

Ed-Afree 图.png

E D -A f ree 散点和趋势线图

FretThaData.csv

FRET 双杂交分析结果数据

FretThaResults.csv

FRET 双杂交分析结果拟合参数

（图 2.7），从而实现了软件的解耦设计。基于 FRETScope 显微成像系统的多模态数据
特征，数据层采用 FretImage-FretDataPiece-FretRecord 三级关联模型（图 2.8），实现了
从原始图像到分析结果的全流程数据管理。按照 FRET 双杂交数据处理步骤流程，将软
件的功能划分为成像参数设置、数据检验、FRET 图像处理、数据管理和结果可视化五
个功能模块。技术实现方面，开发了基于 OpenCV 的 FRET 图像处理库，封装了包括中
值滤波、Otsu 阈值分割等图像处理算法（表 2.1）。基于 OpenCV、dlib 等开源计算库，
本章构建了包含 FRET 定量计算器、图像处理器和双杂交求解器的后台接口，实现了
E-FRET、33 -FRET 等多模态计算。在 L-FRET 分析中，采用基于 BFGS 算法的非线性
优化策略（代码 2.3），完成 Langmuir 模型的参数拟合。得益于分层架构设计和功能模
块化设计，本章实现了每个功能模块，支持了 FRET 双杂交分析的复杂数据处理功能。
Fretha 是一款拥有用户友好界面、简单易用、处理高效的 FRET 双杂交分析专业数据处
理软件。

第 36 页

FRET 双杂交分析数据处理软件的设计与开发

3

Fretha 的验证和测试

引言

3.1

软件测试在保障软件可靠性、安全性及合规性方面发挥核心作用，通过早期缺陷
检测显著降低长期成本 [49, 50] 。本章通过应用 Fretha 进行手动数据处理应用，首先对
标准质粒 C4Y、C10Y、C40Y、C80Y 的 E-FRET 定量分析和 33 -FRET 定量分析，检测
Fretha 计算 FRET 效率的精度。接着，使用 Fretha 手动测量标准质粒 C32V 和 CVC 质
粒中 Cerulean 与 Venus 的化学计量比，对比文献值验证 Fretha 的手动分析 FRET 双杂交
分析的准确性。针对软件的各个功能模块进行了测试，包括成像参数设置模块、数据检
验模块、FRET 图像处理模块、数据管理模块、结果可视化模块等。针对软件系统的可
靠性，本章测试了软件在长时间运行和高频操作下的表现。综合验证实验和模块测试
结果表明，Fretha 在功能丰富度、性能表现和稳定性方面均达到了预期目标，能够满足
复杂科研和高通量应用需求。

材料与方法

3.2
3.2.1

细胞培养与转染

标准质粒实验中，中国科学院细胞库提供的 MCF-7 细胞株在含有 10% 胎牛血清、
100 U/mL 青霉素和 100 µg/mL 链霉素的 DMEM 培养基中培养。
Turbofect™ 转染试剂购自美国赛默飞世尔科技公司。所有质粒均由 Steven Vogel
赠送：C17V（Addgene 质粒 # 26395）、C32V（Addgene 质粒 # 26396）、mVenus N1
（Addgene 质粒 # 27793）、mCerulean C1（Addgene 质粒 # 27796）、CVC（Addgene 质
粒 # 27809）[51, 52] 。
青色荧光蛋白（Cyan Fluorescent Protein, CFP）- 黄色荧光蛋白（Yellow Fluorescent
Protein, YFP）二聚体质粒包括 YFP-G4-CFP（C4Y）
、YFP-G10-CFP（C10Y）
、YFP-G40-CFP
（C40Y）和 YFP-G80-CFP（C80Y），由 Christian Wahl-Schott 赠送 [32] 。
第 37 页

华南师范大学硕士学位论文

CFP-Bcl-xL 质粒由 A. P. Gilmore 提供 [53] ，YFP-Bak 质粒的构建方法已先前报道过
[54]

。药物 A1331852 购自美国新泽西州 MCE 公司。

3.2.2

FRET 成像系统

本研究中，所有实验数据均使用自主研发的多模态 FRET 成像系统 FRETScope 获
取 [55] 。标准 CFP - YFP 质粒选用了 20 倍的 0.45NA 物镜（Olympus，日本）和 6% 光照
强度。Cerulean - Venus 模型质粒实验选用了 20 倍的 0.45NA 物镜（Olympus，日本）和
50% 光照强度。实验过程中，在 AA 通道寻找视野，然后依次捕获 AA、DA 和 DD 通
道的荧光图像。
对于 CV 质粒，串扰因子 a 和 b 通过单转 Venus 质粒测量，串扰因子 c 和 d 通过单
转 Cerulean 质粒测量，系统校正因子 G 和 k 和 εA {εD 是由标准质粒 C17V 和 C32V 测
量。对于 CY 质粒，串扰因子 a 和 b 通过单转 YFP 质粒测量，串扰因子 c 和 d 通过单
转 CFP 质粒测量，系统校正因子 G 和 k 和 εA {εD 是由标准质粒 C4Y、C10Y、C40Y 和
C80Y 质粒测量。所有的 FRET 成像参数如表 3.1 所示。
表 3.1 FRET 成像系统参数

3.2.3

参数名

CV 质粒成像参数

CY 质粒成像参数

a

0.206

0.160

b

0.040

0.002

c

0.047

0.003

d

0.789

0.784

G

4.224

6.430

k

0.635

0.406

εA {εD

0.077

0.064

使用 Fretha 手动处理数据

使用 Fretha 手动处理数据的步骤如下：
(1) 打开 Fretha 软件，点击“FRET 参数”按钮，按照表 3.1 中的参数设置成像参数；
(2) 返回开始界面，点击“浏览”按钮，选择数据文件夹，点击“开始”按钮，进入数
第 38 页

FRET 双杂交分析数据处理软件的设计与开发

据处理界面；
(3) 进入 FRET 图像处理模块，选择三通道信号背景比大于 3 且区域均匀的 ROI，记录
到数据区；
(4) 点击“筛选数据”，排除异常的数据和离群值；
(5) 点击“开始计算”，进入结果展示页界面，点击“保存结果”按钮，保存数据处理
结果。

结果

3.3
3.3.1

E-FRET 和 33 -FRET 验证实验

准确获取可靠的 33 -FRET 和 E-FRET 的测量结果如供受体视角的 FRET 效率 E A
和 E D ，是成功进行 FRET 双杂交分析的必要前提。本章首先对青色荧光蛋白（Cyan
Fluorescent Protein, CFP）和黄色荧光蛋白（Yellow Fluorescent Protein, YFP）构建体的
单质粒进行了 33 -FRET 和 E-FRET 测量，具体包括 C4Y、C10Y、C40Y 和 C80Y。这些
质粒中的受体和供体的比例均为 1:1，但是拥有不同的 E D 值。
使用 Fretha 手动处理每个质粒时，在不同视野共选取 100 个 ROI，然后统计 Fretha
数据区自动计算的 E-FRET 和 33 -FRET 结果，如表 3.2 所示。Fretha 手动处理的标准
质粒 C4Y 的效率为 E A “ 0.291 ˘ 0.020，E D “ 0.307 ˘ 0.040，受体与供体的浓度比
为 RC “ 0.994 ˘ 0.096。对比 C4Y 的文献值 E A “ 0.296 ˘ 0.001，E D “ 0.299 ˘ 0.004，
RC “ 1，发现使用 Fretha 手动数据处理方法的结果均与文献值一致。C10Y、C40Y 和
C80Y 的效率和浓度比也与文献值一致，E A 、E D 和 RC 的平均相对误差为 3.9%、2.2%
和 0.8%，说明 Fretha 手动数据处理的精度较高。

3.3.2

FRET 双杂交验证实验

为了模拟 FRET 双杂交实验，本节使用 Fretha 手动测量了活的 MCF-7 细胞中存在
自由供体（Cerulean, C）和自由受体（Venus, V）时固定质粒 C32V 和 CVC 的 E A,max 、
E D,max 和 nD {nA 值。图 3.1 展示了共表达 C32V / CVC 且含有游离的 C（C32V + C，CVC

第 39 页

华南师范大学硕士学位论文

表 3.2

手动定量 33 -FRET 和 E-FRET 分析标准质粒结果

Fretha 手动处理结果

样本

文献结果

EA

ED

RC

EA

ED

RC

C4Y

0.291 ˘ 0.020

0.307 ˘ 0.040

0.994 ˘ 0.096

0.296 ˘ 0.001

0.299 ˘ 0.004

1

C10Y

0.243 ˘ 0.031

0.230 ˘ 0.022

0.992 ˘ 0.083

0.228 ˘ 0.002

0.223 ˘ 0.003

1

C40Y

0.159 ˘ 0.018

0.155 ˘ 0.011

0.991 ˘ 0.078

0.156 ˘ 0.002

0.158 ˘ 0.002

1

C80Y

0.118 ˘ 0.019

0.117 ˘ 0.012

1.041 ˘ 0.109

0.116 ˘ 0.001

0.116 ˘ 0.002

1

图 3.1 Fretha 手动处理的 C32V 和 CVC 的 FRET 双杂交分析结果
+ C）（上半部分）或游离的 V（C32V + V, CVC + V）（下半部分）的活 MCF7 细胞的
三张荧光图像（DD、AA 和 DA）（左侧），使用 Fretha 手动标注的 ROI（中间），以
及 DC-FRET 和 L-FRET 的结果图（右侧）。
DC-FRET 数据处理过程中的具体参数设置如下：C32V，选取 RC 在 0-0.7 之间的数
据用于斜率拟合 E A,max ，选取 1{RC 在 0-0.8 之间的数据用于斜率拟合 E D,max ，测定的
E A,max 为 0.318，E D,max 为 0.297，nD {nA 为 1.071；对 CVC，选取 RC 在 0-0.2 之间的数
据用于斜率拟合 E A,max ，选取 1{RC 在 0-1.2 之间的数据用于斜率拟合 E D,max ，测定的
E A,max 为 0.795，E D,max 为 0.393，nD {nA 为 2.023。L-FRET 测量得到 C32V 的 E A,max 为
0.347，E D,max 为 0.344，nD {nA 为 1.033，CVC 的 E A,max 为 0.827，E D,max 为 0.419，nD {nA
第 40 页

FRET 双杂交分析数据处理软件的设计与开发

为 2.046。文献报道的 C32V 的 E D,max 为 0.311，nD {nA 为 1，CVC 的 E D,max 为 0.414，
nD {nA 为 2。
所有的测试结果如表 3.3 所示。使用 Fretha 进行 DC-FRET 和 L-FRET 的测量结果
均与文献值一致，说明 Fretha 手动数据处理在准确度上满足预期。
表 3.3

手动处理 C32V、CVC 的 FRET 双杂交分析结果
DC-FRET 结果

样本

L-FRET 结果

文献结果

E A,max

E D,max

nD {nA

E D,max

E D,max

nD {nA

E D,max

nD {nA

C32V

0.318 ˘ 0.036

0.297 ˘ 0.018

1.071 ˘ 0.144

0.347

0.344

1.033

0.311

1

CVC

0.795 ˘ 0.018

0.393 ˘ 0.023

2.023 ˘ 0.113

0.827

0.419

2.046

0.414

2

Fretha 软件测试

3.4
3.4.1

成像参数设置模块测试

成像参数设置是软件的核心功能之一，直接影响到数据处理结果的准确性。本测
试旨在验证软件成像参数设置功能的正确性和灵活性，确保软件能够及时准确响应参
数的更新设置。
测试时，通过界面操作更新参数，分别用表 3.1 CV 成像参数和 CY 参数处理单
转 CV 体系标准质粒 C32V 和 CY 体系标准质粒 C4Y 样本的 FRET 图像数据，进行
E-FRET 分析计算结果 E D 和 RC 。将参数和数据匹配的实验组记为正面组，将参数不匹
配数据的组别记为反面组，测试结果如表 3.4 所示。
表 3.4

更改参数 C4Y 和 C32V 质粒 E-FRET 测量结果

实验组
正面

反面

参数

样本

ED

RC

CV

C32V

0.299 ˘ 0.022

0.981 ˘ 0.113

CY

C4Y

0.307 ˘ 0.040

0.994 ˘ 0.096

CY

C32V

0.382 ˘ 0.054

0.821 ˘ 0.093

CV

C4Y

0.221 ˘ 0.037

1.313 ˘ 0.135

正面组的测量结果中，C32V 的 E D 为 0.299 ˘ 0.022，RC 为 0.981 ˘ 0.113，C4Y 的
第 41 页

华南师范大学硕士学位论文

E D 为 0.307 ˘ 0.040，RC 为 0.994 ˘ 0.096，均与文献值一致。反面组的测量结果中，
C32V 的 E D 为 0.382 ˘ 0.054，RC 为 0.821 ˘ 0.093，C4Y 的 E D 为 0.221 ˘ 0.037，RC 为
1.313 ˘ 0.135，与文献值存在较大偏差。说明参数 Fretha 后台能够及时使用更新后的参
数进行计算。
经过对界面和计算结果的检查和测试，成像参数设置模块的界面和功能均符合预
期，软件界面和后台内存中的参数均能准备设置更新。

3.4.2

数据检验模块测试

如 2.4.2 节所述，数据检验模块用于检查数据的完整性和安全性，防止非法数据对
软件运行造成不可预测的影响。本测试旨在验证软件数据检验模块的有效性，并检查
软件对于异常数据的识别能力和隔离能力。
测试时，使用 Fretha 分别尝试打开 FRET 标准数据、FRET 缺失数据、非 FRET 数
据、空数据、异常数据，检查软件的数据检验模块的反应。具体测试内容和结果如表
3.5 所示。
表 3.5 Fretha 数据检验模块测试结果
测试数据

视野文件夹内容

可打开

可计算

识别类别

是否符合预期

3

3

FRET

3

3

7

Unknown

3

3

7

Unknown

3

7

7

Unknown

3

3

7

Unknown

3

DD.tif
FRET 标准数据

DA.tif
AA.tif

FRET 缺失数据

DD.tif
DA.tif

非 FRET 数据

D.tif
A.tif

空数据

空
DD.tif（损坏）

损坏数据

DA.tif
AA.tif

结果表明，对于正常数据（FRET 标准数据），数据检验模块能够正确识别数据类
第 42 页

FRET 双杂交分析数据处理软件的设计与开发

表 3.6 ROI 绘制功能测试结果
鼠标位置

鼠标样式

按下效果

是否符合预期

ROI 内部

手型

移动 ROI

3

ROI 左边框

水平箭头

调整 ROI 宽度

3

ROI 右边框

水平箭头

调整 ROI 宽度

3

ROI 上边框

垂直箭头

调整 ROI 高度

3

ROI 下边框

垂直箭头

调整 ROI 高度

3

ROI 外部

十字形

新建 ROI

3

型，并且能够成功打开和计算数据，符合预期。对于视野子文件夹中存在缺失数据、非
FRET 数据、空数据和损坏数据等情况，Fretha 能够打开并显示在视野区，但无法打开
或者参与自动计算，并且会被正常识别为“Unknown”类别以提醒用户该视野处于不可
计算的状态。点击“自动圈点”后，发现自动算法也能够成功忽略被识别为“Unknown”
类别的视野，不会对其进行计算。这些结果均符合预期，说明软件数据检验模块的功能
正常，能够有效识别和阻止异常数据的计算。

3.4.3

FRET 图像处理模块测试

FRET 图像处理模块能够帮助用户进行 FRET 双杂交分析数据处理，其功能如 2.4.3
节所述。在测试时，我们主要测试 FRET 图像处理的视图增强、ROI 编辑和 ROI 状态
栏更新功能，以验证软件的功能是否符合预期。
首先测试 FRET 视图增强功能，分别切换表 2.3 中的视图类型，查看视图增强的效
果，过程中的软件界面和增强视图的截图如图 3.2 所示。结果表明，软件能够正确显示
不同类型的视图，并且视图增强的效果明显，提高了用户在圈选 ROI 时的针对性和准
确性。
然后测试 ROI 绘制功能。ROI 编辑功能根据鼠标与 ROI 边框的位置关系，显示不
同的鼠标样式。分别移动鼠标位置到 ROI 内部、边框和外部的，观察鼠标的样式和按
下时对应的功能。测试结果如表 3.6 所示，表明软件能够正确显示不同的鼠标样式，且
在不同位置对应的功能正确，响应迅速，保证了 ROI 绘制的操作体验。
第 43 页

华南师范大学硕士学位论文

图 3.2 Fretha 图像处理视图切换测试结果

最后测试 ROI 状态栏的更新。ROI 状态栏上的数据更新发生在 ROI 被绘制更新以
及视野切换时，因此通过编辑 ROI 和切换视野两种操作来测试 ROI 状态栏的更新，然
后检查 ROI 状态栏的信息是否能够实时更新，结果如表 3.7 所示。
上述测试结果表明，FRET 图像处理的视图增强、ROI 绘制和 ROI 状态栏更新功能
均符合预期，软件能够正确显示不同类型的视图，辅助用户更好完成 FRET 双杂交分析
图像处理工作。
第 44 页

FRET 双杂交分析数据处理软件的设计与开发

表 3.7 ROI 状态栏功能测试结果
测试目标

3.4.4

测试结果

是否符合预期

更新 ROI 结果

切换视野结果

DD 通道信号

数据更新

重置为 0

3

DA 通道信号

数据更新

重置为 0

3

AA 通道信号

数据更新

重置为 0

3

DD 通道 SBR

数据更新

重置为 0

3

DA 通道 SBR

数据更新

重置为 0

3

AA 通道 SBR

数据更新

重置为 0

3

DD 通道背景

保持不变

数据更新

3

DA 通道背景

保持不变

数据更新

3

AA 通道背景

保持不变

数据更新

3

FC

数据更新

重置为 0

3

ED

数据更新

重置为 0

3

RC

数据更新

重置为 0

3

数据管理模块测试

数据管理模块能够管理和组织数据区记录的数据，包括数据导入、数据导出、数据
保存、数据计算等功能，如 2.4.4 节所述。本节重点关注验证数据导入、数据导出和功
能。
测试时的具体步骤如下：
(1) 使用导出数据功能导出圈点信息，检查文件生成和内容是否正确；
(2) 清空数据区，然后使用导入数据功能导入 Fretha 圈点数据（CSV），检查数据是否
正确导入；
(3) 将导出文件另存为其他格式（XLSX），尝试导入 XLSX 文件，检查数据是否正确
导入；
(4) 将另一组数据集生成的 CSV 文件导入，检查数据是否正确导入；
测试结果如表 3.8 所示。当导入 Fretha 圈点数据（CSV），软件能够成功导入数据，
数据准确无误。导入 XLSX 格式的数据时，软件无法导入。当导入不匹配 Fretha 数据
第 45 页

华南师范大学硕士学位论文

（CSV）时，软件能够检测到数据不匹配，终止导入。导出功能能够成功导出 Fretha 圈
点数据（CSV），数据准确无误。添加数据和删除数据功能均工作正常，且通过鼠标和
快捷键均可以快速添加和删除数据。
表 3.8
测试目标
清空数据
筛选数据

导入数据

导出数据
添加数据

删除数据
开始计算

3.4.5

数据管理模块测试结果

测试内容

测试结果

是否符合预期

清空数据区

成功清空

3

快捷键“C”

成功清空

3

筛选数据

成功筛选

3

导入 Fretha 圈点数据（CSV）

成功导入

3

导入其他表格类型数据（XLSX） 无法导入

3

导入不匹配 Fretha 数据（CSV）

无法导入

3

导出 Fretha 圈点数据（CSV）

成功导出

3

添加新数据

成功添加

3

快捷键“A”

成功添加

3

删除数据

成功删除

3

快捷键“D”

成功删除

3

开始计算数据

成功跳转，计算准确

3

结果可视化模块测试

结果可视化和保存模块能够帮助用户查看和保存数据处理结果，包括视图选择、图
表结果、结果保存等，如 2.4.5 节所述。本节对上述功能进行测试和验证，重点关注两
种视图的显示和参数的更新，以及结果的保存功能。
测试 L-FRET 视图和 BIN 数据分箱功能，测试结果如图 3.3 所示。L-FRET 显示出
良好的拟合效果，散点与趋势线符合预期。测试所用的 BIN 参数为对 RC 在 p0, 5q 之间
的数据按照 0.01 的步长进行分组并计算平均值，结果显示 BIN 参数更新后的 L-FRET
视图散点数明显减少，且趋势线有所变化。
测试 DC-FRET 视图中调整线性拟合的数据范围参数设置功能时，首先设置线性拟
合的 RC 数据范围为 p0, 0.5q，均值拟合的 RC 范围为 p2, 10q，然后设置线性拟合的 1{RC
数据范围为 p0, 1q，均值拟合的 1{RC 范围为 p1, 10q，观察图表中的趋势线和散点图更
第 46 页

FRET 双杂交分析数据处理软件的设计与开发

图 3.3 Fretha L-FRET 视图测试结果。图 a 为标准 L-FRET 视图，图 b 为应用 BIN 数据
分箱后的 L-FRET 视图。
新。测试结果如图 3.4 所示，当扩大拟合数据的范围后，可以观察到趋势线的更新，斜
率拟合段和均值拟合段均延伸至 RC 为 1 的位置。
测试保存的数据和报告是否能够正确保存，结果如图 3.5 所示，软件能够正确生成
结果文件，且数据和报告的内容准确无误，符合预期。
综合测试结果表明，Fretha 结果可视化模块的功能正常，能够正确显示和保存数据
处理结果，为用户提供了直观的数据分析和保存功能。

3.5

Fretha 可靠性测试
可靠性测试旨在评估 Fretha 软件在长时间运行、高负载或异常操作下的可靠性。测

试从：
(1) 压力测试：同时加载 10 个大型 FRET 数据集（每个数据集包含 50 个视野），连续
执行参数设置、图像处理和结果计算操作，监测软件是否出现崩溃或内存泄漏。
第 47 页

华南师范大学硕士学位论文

图 3.4 DC-FRET 视图测试结果。图 a 为设置线性拟合的 RC 数据范围为 p0, 0.5q，均
值拟合的 RC 范围为 p2, 10q 时 Fretha 生成的趋势线和散点图；图 b 则设置线性拟合的
1{RC 数据范围为 p0, 1q，均值拟合的 1{RC 范围为 p1, 10q。

图 3.5 Fretha 结果保存测试结果

第 48 页

FRET 双杂交分析数据处理软件的设计与开发

(2) 长时间运行测试：保持软件连续运行 48 小时，期间每隔 8 小时进行数据导入、数
据计算和保存，然后清空数据。记录软件内存占用情况，检测软件是否存在内存泄
露
(3) 异常操作测试：快速重复进行参数切换、数据导入导出、ROI 编辑等操作，模拟用
户高频使用场景，观察软件的响应稳定性。
测试结果如表 3.9 所示，Fretha 在压力测试下仍能稳定处理数据，未出现崩溃或内
存溢出；长时间运行中的内存占用监测如图 3.6 所示，功能模块保持正常，资源占用无
显著异常；高频操作下软件响应迅速，未出现卡顿或错误。这些结果证明 Fretha 具有良
好的稳定性，能够满足科研和工业场景的长时间、高负载使用需求。

图 3.6 Fretha 软件 48 小时运行内存占用监测

3.6

本章小结
本章首先通过标准质粒的 E-FRET 分析和 33 -FRET 分析，验证了 Fretha 手动数据

处理计算 FRET 效率的准确性。在核心数据 E A 、E D 和 RC 的测定中，Fretha 计算 C4Y、
C10Y、C40Y 和 C80Y 的结果与文献值一致，准确度符合预期。然后，本章针对各功能
模块进行了单独测试，包括成像参数设置模块、数据检验模块、FRET 图像处理模块、
数据管理模块、结果可视化模块。每个模块的核心功能均通过测试，验证了软件的功能
完整。可靠性测试进一步验证了 Fretha 在长时间运行、高负载和高频操作下的可靠性，
第 49 页

华南师范大学硕士学位论文

表 3.9 Fretha 软件可靠性测试结果
测试类型

压力测试

长时间运行测试

测试方法

测试结果

同时加载 10 个大型 FRET 数据

- 处理 10 个数据集总耗时：42.5

集（每个数据集包含 50 个视

分钟

野），连续执行参数设置、图像

- 内存峰值占用：1.4 GB（稳定

处理和结果计算操作，监测软

无泄漏）

件是否出现崩溃或内存泄漏。

- 操作成功率：100%

保持软件连续运行 48 小时，期

- CPU 平均使用率：22-25%（波

间定期检查各功能模块（如图

动＜ 3%）

像处理、数据导出）是否正常

- 内 存 平 均 占 用：550-600 MB

工作，记录 CPU 和内存占用情 （无持续增长）

异常操作测试

况。

- 数据导出成功率：100%

快速重复进行参数切换、数据

- 每秒操作次数：15-20 次 / 秒

导入导出、ROI 编辑等操作，

- 平均响应时间：0.3-0.5 秒

模拟用户高频使用场景，观察

- 未出现卡顿或界面冻结

软件的响应稳定性。

未出现崩溃或性能下降的情况。综合测试结果表明，Fretha 软件测量准确、功能完善、
可靠性良好，能够满足复杂科研和实际应用的需求。

第 50 页

FRET 双杂交分析数据处理软件的设计与开发

4

基于 LURS 的自动 FRET 双杂交分析

引言

4.1

Fretha 的推出有效的解决了数据处理过程复杂耗时的问题，降低了数据处理的门
槛。但是当面对大规模的数据时，依靠 Fretha 进行数据处理仍然依赖人工标注 ROI，无
法满足高通量等大规模数据场景的应用要求。
当前 FRET 技术中自动提取 ROI 的方法主要靠有监督的机器学习方法，像 U-Net
模型和 ilastik 工具。但这些神经网络算法需要制备优质的具有特异性的数据集，并且难
以解释其运作的原理。另一种思路是通过增大模型参数规模，然后在通用数据集上训
练，其具备良好的泛化能力，只需要在特定的图像上进行微调或者给出一些标注，如
SAM 大模型和 SAM-Med2D 等[56–58] 。
针对这些问题，本章提出基于亮度均匀性的 ROI 选择（LURS）算法用于荧光数据
提取。该算法受到人工处理数据时重要的明度（Luminance）和均匀度（Uniformity）启
发，利用局部标准差排除灰度突变区域，提升数据提取质量。通过 C4Y、C10Y、C40Y
和 C80Y 标准质粒和 C32V 和 CVC 双杂交模型质粒的验证实验，验证了 LURS 算法在
FRET 效率和化学计量比的计算精度。本章还应用 URS 方法分析药物 A1331852 处理的
活细胞中 Bcl-xL 和 Bak 相互作用的化学计量比，成功检测了两者结合化学计量比的下
降，且在高通量场景下 LURS 分析处理的结果优于深度学习的方法和工具，表现出良好
的准确性和鲁棒性。通过对比 LURS、SAM-Med2D、ilastik 算法的性能，探讨了 LURS
在高通量检测和即时在线计算的应用潜力。

材料与方法

4.2
4.2.1

细胞培养与转染

在 Bcl-xL-Bak 药 效 检 测 实 验 中， 将 MCF-7 细 胞 （4000 个 细 胞 / 孔） 接 种 于 含
DMEM 培养基和 10% 胎牛血清的 96 孔板（中国 LABSELECT 公司），置于 37˝ C、5%
第 51 页

华南师范大学硕士学位论文

CO2 培养箱中孵育 12 小时。每孔转染 400 ng 质粒，并以 3:1 或 1:3 的比例形成转染复
合物。其余细胞培养与质粒转染方法均与第 3.2.1 节相同。

4.2.2

FRET 成像系统

本章使用的成像系统及成像参数与第 3.2.2 节相同。

4.2.3

基于明度和均匀度的自动 ROI 选取算法（LURS）

不失一般性，我们将 ROI 定义为 n ˆ n 的正方形区域，这种设计简化了标注过程并
增强了基于积分的图像优化方法的适用性，从而显著提升计算效率 [59] 。参数 n 与细胞
的像素面积相关，在本文实验采用的 20 倍放大倍率下被设定为 5。
LURS 算法包含以下步骤：
(1) 图像预处理。对 FRET 三通道图像的预处理主要包括原始图像的平滑处理和背景
灰度值的扣除。从三个通道采集的原始图像分别记为 IRaw,DD 、IRaw,DA 和 IRaw,AA 。为
了获得更精确的定量分析结果，我们采用高斯模糊对图像进行平滑处理，利用钟
形曲线为像素分配权重影响 [60, 61] 。背景强度（IBG ）通过识别直方图中出现频率最
高的像素值确定，因为图像中大部分像素属于背景且灰度值集中 [62] 。背景强度的
计算公式为：
IBG “ arg maxH p pq,

(4.1)

p

其中 p 遍历所有可能的像素值，arg maxH p pq 表示使 H p pq 达到最大值的像素值 p，
p

该值即为计算得到的背景强度 IBG 。处理后的图像重新命名为 IDD 、IDA 和 IAA ，准
备进行后续处理。
(2) 基于亮度的自适应阈值分割。在荧光成像中，避免低亮度区域（如细胞空腔）对于
获取高质量荧光信号至关重要。传统单阈值方法可能错误滤去低亮度细胞，或者
错误保留不应参与荧光分析的明亮空腔。本文采用局部自适应阈值方法对平滑后
的图像（IDD 、IDA 和 IAA ）进行二值化分割。像素 p x, yq 的阈值 T L p x, yq 和二值化结

第 52 页

FRET 双杂交分析数据处理软件的设计与开发

果 Mask L p x, yq 计算如下：
1
T L p x, yq “
wˆw

1
x` w´
2

1
y` w´
2

ÿ

ÿ

1
i“ x´ w´
2

1
j“y´ w´
2

Mask L p x, yq “

I pi, jq ` bL ,

$
’
’
’
& 1,

I p x, yq ě T L p x, yq

’
’
’
% 0,

I p x, yq ă T L p x, yq

,

(4.2)

(4.3)

其中 I p x, yq 为输入图像的灰度值，w 为大于等于 4n ` 1 但不超过细胞长宽四分之
一的奇数（本文设置为 21），bL 为偏置项（值被设置为各通道通过公式 4.1 计算的
背景灰度值），确保完全去除背景区域。
(3) 三通道掩码合并生成 Mask L,M 。三通道图像的掩码通过逻辑与操作合并生成最终掩
码：

Mask L,M p x, yq “ Mask L,DD p x, yq ^ Mask L,DA p x, yq ^ Mask L,AA p x, yq,

(4.4)

其中 Mask L,DD 、Mask L,DA 和 Mask L,AA 是基于式 4.3 生成的各通道掩码，Mask L,M
为合并结果。
(4) 计算 ROI 的 CV 矩阵。均匀性反映特定区域内荧光信号的一致性，对保证实验数
据的可靠性和可重复性具有重要意义。本文采用变异系数（CV）评估 ROI 内的灰
度均匀性：
CV ROI “ S tdDevROI { MeanROI ,

(4.5)

其中 MeanROI 为 ROI 内像素的平均灰度值，S tdDevROI 为标准差。然后，计算每个
ROI 的 CV 值并存储为 CV 矩阵（MatCV ）。同时生成均值矩阵 Mat Mean 存储各 ROI
的均值，像素 p x, yq 的值计算为：
1
Mat Mean p x, yq “
nˆn

1
x` n´
2

1
y` n´
2

ÿ

ÿ

1
i“ x´ n´
2

1
j“y´ n´
2

第 53 页

I pi, jq,

(4.6)

华南师范大学硕士学位论文

其中 n 为 ROI 宽度。基于均值矩阵，标准差矩阵计算为：
g
f
f
f 1
MatS td p x, yq “ e
nˆn

1
x` n´
2

1
y` n´
2

ÿ

ÿ

I pi, jq2 ´ Mat Mean p x, yq2 ,

(4.7)

1
n´1
i“ x´ n´
2 j“y´ 2

将各 ROI 的 CV 值存入 MatCV ：
MatCV “ MatS td p x, yq{ Mat Mean p x, yq,

(4.8)

并通过线性变换将浮点型 CV 值转换为 16 位整数：
^
MatS td p x, yq ´ S tdmin
ICV p x, yq “
ˆ 65535 ` 0.5 ,
S tdmax ´ S tdmin
Z

(4.9)

其中 S tdmin 和 S tdmax 为 MatCV 的最小和最大 CV 值，ICV 为转换后的 0-65535 范围
的整数值。
(5) 基于均匀性的自适应阈值分割 CV 矩阵。三通道 CV 矩阵记为 ICV,DD 、ICV,DA 和
ICV,AA 。采用与生成 Mask L 相同的方法生成基于均匀性的掩码（保留更低 CV 值的
区域）。像素 p x, yq 的阈值计算为：
1
T U p x, yq “
wˆw

1
x` w´
2

1
y` w´
2

ÿ

ÿ

ICV pi, jq ` bU ,

(4.10)

1
1
i“ x´ w´
j“y´ w´
2
2

MaskU p x, yq “

$
’
’
’
& 1,

I p x, yq ă T U p x, yq

’
’
’
% 0,

I p x, yq ě T U p x, yq

,

(4.11)

其中 bU 通过公式 4.1 对 ICV p x, yq 计算得到。
(6) 三通道均匀性掩码合并生成 MaskU,M 。其中 MaskU,DD 、MaskU,DA 和 MaskU,AA 是基
于公式 4.11 生成的各通道均匀性掩码，MaskU,M 为合并结果。

MaskU,M p x, yq “ MaskU,DD p x, yq ^ MaskU,DA p x, yq ^ MaskU,AA p x, yq,

(4.12)

(7) 合并亮度掩码与均匀性掩码生成 Mask LU 。通过逻辑与操作合并亮度掩码和均匀性

第 54 页

FRET 双杂交分析数据处理软件的设计与开发

掩码：
Mask LU p x, yq “ Mask L,M p x, yq ^ MaskU,M p x, yq

(4.13)

(8) 从 Mask LU 中选择 ROI。对掩码进行连通区域分析，移除面积小于 n ˆ n 的碎片区
域。选择高信噪比像素作为 ROI 中心，通过 Mat Mean 获取对应位置的信号值。
LURS 算法流程如图 4.1 所示：

图 4.1 LURS 算法流程图

4.2.4

基于 LURS 的自动 FRET 双杂交分析

将 LURS 算法结合 Fretha 的数据计算处理能力，实现了全自动的 FRET 双杂交分
析。点击 FRET 图像处理模块左下角的“自动圈点”按钮，软件将会调用 LURS 算法进
行自动 ROI 圈点生成，并记录到右侧的数据区。计算过程中，Fretha 界面通过进度条显
示计算进度，方便用户查看。基于 LURS 的自动圈点功能被封装在子线程服务中，不会
影响 Fretha 前台界面显示和操作。
第 55 页

华南师范大学硕士学位论文

自动 ROI 圈点模块的业务流程及架构如图 4.2 所示。架构层内的流程流转以实线
表示，不同架构层之间的流程流转以虚线表示。在实现自动圈点功能的流程转移中，发
生在架构不同层之间的转移占更多数，而层内的流程转移相对较少，分层架构设计使
得每个层内实现较好的封装，因此在实现复杂业务功能时，只专注于层和层之间的数
据和流程切换即可。

图 4.2 Fretha 自动圈点模块流程

自动 FRET 双杂交分析方法采用 DC-FRET 方法，因为 DC-FRET 方法具有以下优
势：
(1) 简化实验过程：与 L-FRET 方法相比，DC-FRET 方法无需在中间分布状态下准备
大量样本。相反，仅需准备相对较大 RC 值和相对较小 RC 值的样本，这减少了样
本的制备和处理时间。
(2) 得出更稳定可靠的结果：DC-FRET 中用于线性拟合的供体荧光能量转移效率 E D
第 56 页

FRET 双杂交分析数据处理软件的设计与开发

和受供体浓度比 RC 数据是通过 E-FRET 和 33 -FRET 方法进行定量测量的，该方法
具有较高的准确性和稳定性，能够提供可靠的数据，使得线性拟合的结果更加稳
定可靠。
然而，DC-FRET 方法在选择 RC 或 1{RC 的范围时需要一定经验。如果所选范围过
小，将会导致数据点不足，从而使结果的稳定性变差。当拟合范围过大时，结果可能会
不正确，因为所选数据不满足尽可能选择受体饱和结合或者供体饱和结合情况。为了
避免使用数据中的不稳定部分，本文中所有自动算法中进行的 DC-FRET 分析均遵循如
下原则：
(1) 如果样本仅包含供体饱和的情况或仅包含受体饱和的情况，应选择 RC （1{RC ）值
相对较小的 50% 的数据。
(2) 当受体饱和和供体饱和同时存在时，则应选择 RC （1{RC ）值较小的 25% 的数据。

实验结果

4.3
4.3.1

E-FRET 和 33 -FRET 验证实验

标准质粒验证实验的目的和质粒详情与第 3.3.1 节相同。测量的结果列于表 4.1 中。
表 4.1

对标准质粒进行 33 -FRET 和 E-FRET 测量的结果
测量结果

样本

文献结果

EA

ED

RC

EA

ED

RC

C4Y

0.311 ˘ 0.038

0.293 ˘ 0.023

0.984 ˘ 0.110

0.296 ˘ 0.001

0.299 ˘ 0.004

1

C10Y

0.239 ˘ 0.024

0.214 ˘ 0.022

0.940 ˘ 0.097

0.228 ˘ 0.002

0.223 ˘ 0.003

1

C40Y

0.167 ˘ 0.031

0.152 ˘ 0.014

0.979 ˘ 0.171

0.156 ˘ 0.002

0.158 ˘ 0.002

1

C80Y

0.112 ˘ 0.029

0.114 ˘ 0.020

1.033 ˘ 0.200

0.116 ˘ 0.001

0.116 ˘ 0.002

1

通过对 LURS 提取的 ROI 的 FRET 信号进行计算和统计分析，结果表明：C4Y 的
E A 值为 0.311，E D 值为 0.293，C10Y 的 E A 值为 0.239，E D 值为 0.214，C40Y 的 E A 值为
0.167，E D 值为 0.152，C80Y 的 E A 值为 0.112，E D 值为 0.114。与此同时，C4Y、C10Y、
C40Y 和 C80Y 的 RC 值分别为 0.984、0.940、0.979 和 1.033，与标准值 1 接近。E A 、E D
第 57 页

华南师范大学硕士学位论文

和 RC 的平均相对误差分别为 5.1%、2.9% 和 3.3%。所有质粒的 E A 、E D 和 RC 值都与已
报道的值接近，这表明 LURS 算法能够成功提取出正确且有效的 ROI，为 FRET 双杂交
分析提供了从供体和受体角度的准确 FRET 效率数据。

4.3.2

FRET 双杂交验证实验

本节的测量方法和质粒详情与第 3.3.2 节相同。图 4.3 展示了共表达 C32V / CVC
且含有游离的 C（C32V + C，CVC + C）（上半部分）或游离的 V（C32V + V，CVC +
V）（下半部分）的活 MCF7 细胞的三张荧光图像（DD、AA 和 DA）（左侧），使用
Fretha 手动标注的 ROI（中间），以及 DC-FRET 和 L-FRET 的结果图（右侧）。

图 4.3 在存在游离供体或受体的情况下，分别通过 DC-FRET 和 L-FRET 方法对 MCF7
活细胞中标准质粒（C32V 和 CVC）的 E A,max 、E D,max 和 nD {nA 进行自动 FRET 双杂交
分析测量结果。

C32V 和 CVC 质粒中 Cerulean 与 Venus 之间的结合化学计量比的实验测量结果
见表 4.2。LURS 结合 DC-FRET，测量得到 C32V 质粒中的 E A,max 为 0.322，E D,max 为
0.303，化学计量比（nD {nA ）为 1.063。这个数值与 C32V 预期的供受体比例 1:1 非常接
近。对于 CVC 质粒，E A,max 、E D,max 和 nD {nA 的值分别为 0.764、0.402 和 1.900，所获
第 58 页

FRET 双杂交分析数据处理软件的设计与开发

得的结果与先前文献中报道的结果一致 [51] 。结合 L-FRET，LURS 自动处理计算得到的
C32V 质粒中的 E D,max 为 0.342，E D,max 为 0.372，化学计量比（nD {nA ）为 0.919。对于
CVC 质粒，E D,max 、E D,max 和 nD {nA 的值分别为 0.791、0.442 和 1.790，与文献报道的结
果一致 [52] 。这些结果表明，LURS 结合 DC-FRET 和 L-FRET 方法成功识别到了它们的
化学计量比的差别，且计算出的化学计量比和文献结果的相对误差不超过 6%，进一步
证明了 LURS 算法提取高质量 ROI 的准确性。
表 4.2

模型质粒的 FRET 双杂交分析结果

DC-FRET 结果

样本

L-FRET 结果

文献结果

E A,max

E D,max

nD {nA

E D,max

E D,max

nD {nA

E D,max

nD {nA

C32V

0.322 ˘ 0.041

0.303 ˘ 0.012

1.063 ˘ 0.143

0.342

0.372

0.919

0.311

1

CVC

0.764 ˘ 0.018

0.402 ˘ 0.024

1.900 ˘ 0.113

0.791

0.442

1.790

0.414

2

4.3.3

活细胞中 Bcl-xL-Bak 化学计量比的自动分析

为了评估基于 LURS 算法的自动 FRET 双杂交分析的应用潜力，本节应用自动方法
研究选择性 Bcl-xL 抑制剂 A1331852 存在下的 Bcl-xL-Bak 相互作用的化学计量比变化。
A1331852 是具有口服活性的 Bcl-xL 的抑制剂，能够竞争性结合 Bcl-xL，抑制 Bcl-xL
与促凋亡蛋白结合，从而抑制 Bcl-xL 的抗凋亡能力 [63, 64] 。
为了对比 LURS 和深度学习方法的自动 ROI 选取效果，本节分别测试了对相同数
据应用基于 ilastik 的方法基于 SAM-Med2D 的方法自动处理相同的输入数据，然后对
比了不同方法的精确度和对药物敏感度的测试。FRET 定量计算、FRET 双杂交计算均
通过 Fretha 内部的相同算法进行处理。在图像处理和 ROI 上，基于 ilastik 的方法通过
少量标注交互，对输入的 10 个视野 30 张荧光细胞图像的像素分类为好细胞、坏细胞和
背景区域，然后应用训练后的 ilastik 的模型进行自动分割，完成了对 ROI 的选取。基
于 SAM-Med2D 的方法通过对图像进行专家标注分为好细胞和背景区域，然后作为大
模型输入的提示词（prompt）进行模型调整，最后输入实验用的数据完成自动分割。在
FRET 双杂交分析方法上，由于 DC-FRET 的稳定性优于 L-FRET，本节选用 DC-FRET
第 59 页

华南师范大学硕士学位论文

作为分析方法。
首先，如图 4.4 所示，所有方法均能高精度测量 FRET 效率及化学计量比，并有效
检测药物处理后的 E A,max 、E A,max 和 nD {nA 值的下降。这些结果表明，A1331852 可破坏
Bcl-xL/Bak 相互作用，导致受体中心的 FRET 效率、供体中心的 FRET 效率和化学计量
比均显著降低，且与手动分析结果趋势一致，验证了不同方法的测量一致性。

图 4.4 活细胞中 Bcl-xL-Bak 化学计量比的自动分析方法对比。手动、ilastik、SAMMed2D 及本方法计算的，A1331852 处理前（a，b）和处理后（c，d）Bcl-xL-CFP 与
Bak-YFP 结合的最大 33 -FRET（黑色）和 E - FRET（红色）效率以及化学计量比（黄色）。

其次，本方法在 FRET 参数测量中表现出优于 SAM-Med2D 和 ilastik 的整体准
确性（表 4.3）。对照组中，本方法测得 E A,max “ 0.27 ˘ 0.03、E D,max “ 0.15 ˘ 0.03。
尽管 SAM-Med2D 的 E A,max （0.29 ˘ 0.04）更接近手动值（0.34 ˘ 0.04），但本方法在
E D,max （0.15 ˘ 0.03 vs 手动 0.17 ˘ 0.03）和化学计量比（nD {nA “ 1.87 ˘ 0.22）上偏差
最小（手动 2.01 ˘ 0.14），而 SAM-Med2D（1.79 ˘ 0.33）和 ilastik（1.74 ˘ 0.19）的化
学计量比偏离更显著。在 A1331852 处理组中，本方法的所有参数均最贴近手动结果：
第 60 页

FRET 双杂交分析数据处理软件的设计与开发

E A,max “ 0.11 ˘ 0.02、E D,max “ 0.10 ˘ 0.03（手动 0.15 ˘ 0.02、0.13 ˘ 0.04），显著优于
SAM-Med2D（0.09 ˘ 0.02）和 ilastik（0.05 ˘ 0.01）。特别值得注意的是，本方法的化
学计量比 nD {nA “ 1.12 ˘ 0.33 与手动结果（1.12 ˘ 0.30）完全一致，而 SAM-Med2D
（1.02 ˘ 0.30）和 ilastik（1.03 ˘ 0.48）表现出更大离散性。这些结果突显了本方法在扰
动条件下定量 FRET 效率与化学计量比的稳健性。
表 4.3 手动、基于 ilastik、基于 SAM-Med2D 及 Fretha 自动方法测量 A1331852 处理前
后 Bcl-xL-CFP 与 Bak-YFP 结合的 DC-FRET 双杂交分析结果。
对照组

方法

加药组

E A,max

E D,max

nD {nA

E D,max

E D,max

nD {nA

Manual

0.34 ˘ 0.04

0.17 ˘ 0.03

2.01 ˘ 0.14

0.15 ˘ 0.02

0.13 ˘ 0.04

1.12 ˘ 0.30

ilastik

0.24 ˘ 0.03

0.14 ˘ 0.02

1.74 ˘ 0.19

0.05 ˘ 0.01

0.05 ˘ 0.02

1.03 ˘ 0.48

SAM-Med2D

0.29 ˘ 0.04

0.17 ˘ 0.05

1.79 ˘ 0.33

0.09 ˘ 0.02

0.09 ˘ 0.02

1.02 ˘ 0.30

Ours

0.27 ˘ 0.03

0.15 ˘ 0.03

1.87 ˘ 0.22

0.11 ˘ 0.02

0.10 ˘ 0.03

1.12 ˘ 0.33

4.3.4

自动分析算法性能对比

在相同硬件配置（Intel® Xeon E5-2678 v3 @ 2.50GHz 处理器，NVIDIA® GeForce
RTX 3090 GPU）下，我们对 LURS 算法与两种基于深度学习的自动 ROI 提取方法
（ilastik 和 SAM-Med2D）进行了系统性性能对比。
基于 LURS 和 Fretha 的自动 FRET 双杂交分析流程通过改进四个方面改进将时间
花费从传统手动处理的 3.5 - 7 小时缩短至 30 分钟：
(1) 实时 LURS 驱动的感兴趣区域分割消除了每个样本 2.5 至 3 小时的手动区域选择和
背景校正时间；
(2) 简化的 FRET/DC-FRET 计算模块将计算和拟合时间从 1 小时缩短至不足 5 分钟；
(3) 与数据处理平台直接集成的自动化数据格式转换流程消除了 1 小时的手动数据转
换步骤；
(4) Fretha 平台支持的数据筛选和质量控制，以及易于数据在处理的特效，将数据检查
和再处理时间从 1 小时减少至 20 分钟。
第 61 页

华南师范大学硕士学位论文

如表 4.4 所示，LURS 方法在 1.4GB 数据集（包含 30 个视野的药物处理组和对照
组）中仅需 10 秒即可提取 1515 个可用的 ROI，单 ROI 处理时间低至 6.6 ms。相比之
下，ilastik 和 SAM-Med2D 的单 ROI 处理时间分别为 35.2 ms 和 50.7 ms，LURS 的速度
较 ilastik 提升 5.3 倍，较 SAM-Med2D 提升 7.7 倍。
表 4.4
方法

不同算法的性能对比

单 ROI 处理时间（ms） 内存占用

硬件要求

LURS

6.6

800 MB

CPU

ilastik

35.2

1.8 GB

GPU/CPU

SAM-Med2D

50.7

14 GB

GPU

内存利用率方面，LURS 仅占用约 800 MB 内存，分别为 ilastik（ 1.8 GB）的 44%
和 SAM-Med2D（ 14 GB）的 5.7%。这一优化使得 LURS 在资源受限的环境中仍能高效
运行。此外，LURS 完全依赖 CPU 资源，无需专用 GPU 加速，使其能够直接集成到实
时显微镜成像系统中，为高通量筛选应用提供了硬件无关性和部署灵活性。
综合上述性能分析结果，LURS 在计算速度快、内存占用低、硬件要求低，非常适
合集成在显微镜系统或数据处理计算设备。通过集成在 Fretha 软件系统中进行统一数
据模型管理，优化计算流程和内存管理，LURS 显著提升了处理效率，为实时、高通量
的 FRET 双杂交分析提供了自动化的数据处理能力。

4.4

本章小结
本章提出了一种基于亮度均匀性的自动 ROI 选择算法 (LURS)，以解决传统 FRET

双杂交分析技术中 ROI 标注依赖人工的问题，实现了自动的 FRET 双杂交分析。LURS
算法通过高斯平滑预处理，既实现了对噪声的抑制，又保留了荧光信号的强度信息。通
过局部明度和变异系数双重指标的自适应阈值分割，LURS 保留了细胞中明度较高且荧
光突变小的区域，从而选取了高质量的 ROI。结合 LURS 算法和 DC-FRET 方法的自
动数据选择，本章成功实现了整个 FRET 双杂交分析过程的自动化，并将其作为一个
自动数据处理的功能集成到了 Fretha 中，丰富了软件的功能。应用自动数据处理方法，
第 62 页

FRET 双杂交分析数据处理软件的设计与开发

本章在标准质粒 C4Y/C10Y/C40Y/C80Y 的 33 -FRET 和 E-FRET 验证实验中，E A 、E D 和
RC 测量值相对文献值的平均相对误差分别为 5.1% 和 2.9% 和 3.3%，在 FRET 双杂交
分析验证实验中模型质粒 C32V 和 CVC 的化学计量比分析中，测量的 nD {nA 值分别为
1.063 ˘ 0.143 和 1.900 ˘ 0.113，与理论值 1:1 和 2:1 高度吻合，且计算效率较人工处理
提升 80% 以上。应用自动算法分析活细胞中 Bcl-xL-Bak 之间的相互作用表明，LURS
结合 DC-FRET 算法敏锐地检测到 Bcl-xL 和 Bak 之间的作用计量从 1.87 ˘ 0.22 下降到
1.12 ˘ 0.33，在 ilastik、SAM-Med2D 等方法中最接近人工手动处理的标准结果。这些
结果表明，LURS 算法在 FRET 双杂交分析数据处理中具有较高的准确性和稳定性，为
高通量药物筛选和蛋白质互作研究提供了可靠的技术支撑。

第 63 页

华南师范大学硕士学位论文

5
5.1

总结与展望

本文的主要内容和总结
本文围绕 FRET 双杂交分析数据处理的需求和难点，研发了一款 FRET 双杂交分析

数据处理软件 Fretha，提高了 FRET 双杂交分析技术的规范化水平。针对 FRET 图像处
理时繁杂的人工标注 ROI 工作，本文提出了基于明度和均匀度的 ROI 选取算法 LURS，
基于此实现了自动 FRET 双杂交分析，显著提高了数据处理的效率。本文的研究内容主
要包括以下三个方面：
（1）根据 FRET 双杂交分析数据处理的流程和需求，研发了一款 FRET 双杂交分析
数据处理软件 Fretha。完成了 Fretha 的分层架构设计、模块功能划分、界面设计、模块
开发实现等工作。通过对基本数据模型。本文实现了成像参数设置模块和数据检验模
块，可有效保证数据处理的前置条件和信息检验。FRET 图像处理模块能够切换增强视
图类型，辅助 ROI 状态栏，优化了标注 ROI 时的信息反馈，并且设置了 ROI 的自动化
选取功能，提升了数据处理的效率。数据管理模块提供了数据筛选、数据导入导出、一
键计算等功能，便于用户对数据进行管理和分析，实现了对数据模型的统一管理和在
模块间的高效传递。结果可视化模块提供了数据可视化、结果导出等功能，便于用户对
数据进行分析和展示。Fretha 的专业性和易用性，降低了 FRET 双杂交分析技术的使用
门槛，提高了规范化程度，对于推广 FRET 双杂交分析技术应用具有重要意义。
（2）对 Fretha 软件进行了系统性测试与评估，完成了对 Fretha 软件的功能测试和可
靠性测试。Fretha 的参数设置模块响应及时，能够成功更新成像参数，确保数据计算的
准确性。数据检验模块可以识别并隔离异常数据，确保软件运行的安全稳定。FRET 图
像处理模块的图像显示正常，各个控件的操作响应及时，能够快速标注绘制 ROI，更新
ROI 状态栏信息。数据管理模块能够成功导入导出数据，支持一键计算功能，能够快速
完成数据的计算和结果的导出。结果可视化模块展示了 FRET 双杂交分析视图，支持多
种格式的结果导出，便于用户对数据进行分析和展示。性能测试表明，Fretha 中 LURS
第 64 页

FRET 双杂交分析数据处理软件的设计与开发

算法在 1.4GB 数据集上单 ROI 处理时间仅 6.6 ms，内存占用 800 MB，优于其他软件工
具如 ilastik（35.2 ms / 1.8 GB）和 SAM-Med2D（50.7 ms / 14 GB）。可靠性测试表明，
测试了 Fretha 软件在 48 小时连续运行和高频操作下保持稳定，资源占用无显著波动。
（3）提出了基于明度和均匀度的 ROI 选取算法 LURS，实现了自动 FRET 双杂交
分析。通过多通道自适应阈值分割和变异系数均匀性评估，实现了 ROI 的自动化选
取。LURS 算法通过筛选每个 ROI 在局部的相对亮度和变异系数，有效排除低亮度背景
和灰度突变区域。在标准质粒 C4Y、C10Y、C40Y、C80Y 的 E-FRET 测量和 33 -FRET
测量中，E A 和 E D 值与文献报道值的相对误差小于 5%。在 C32V 和 CVC 模型质粒的
FRET 双杂交验证中，测量得到的 C32V 中 C 与 V 的结合计量比为 1.06，在 CVC 中则
为 1.90，符合文献报道的结果。引用 LURS 算法测量对照组细胞中 Bcl-xL-Bak 相互作
用的化学计量比为 1.87，加药 A1331852 处理组则为 1.12，化学计量比测量结果与手动
分析高度一致。对比基于 SAM-Med2D 和 ilastik 的算法，LURS 表现出良好的准确性和
鲁棒性，适用于高通量药物筛选等大数据量场景。

5.2

展望
本文研发的 FRET 双杂交分析数据处理软件 Fretha 实现了规范化、自动化的 FRET

双杂交分析数据处理，提升了数据处理的效率和准确性。Fretha 的推出为活细胞 FRET
双杂交分析技术提供了标准化、自动化的解决方案，有望推动该技术在精准医疗和药
物研发中的大规模应用。尽管 Fretha 及 LURS 算法已实现 FRET 双杂交分析的自动化
处理，面对未来可能的大数据量数据处理需求，今后的工作可以围绕以下几个方面进
行改进和完善：
（1）集成 LURS 算法到显微镜在线成像系统。本文提出的 LURS 算法在性能上已经
达到了实时数据处理的实验要求，但是目前还需要将显微镜成像系统中的数据通过数
据检验模块导入 Fretha 中离线处理。未来可以考虑将 LURS 算法集成到显微镜成像系
统中，实现实时成像和数据处理，研发智能化的在线成像系统。在线成像系统可以实时
监测细胞的荧光信号变化，自动选取 ROI 并进行数据处理，实时输出 FRET 双杂交分

第 65 页

华南师范大学硕士学位论文

析结果。从而加大显微镜通量，进一步提高 FRET 双杂交实验的效率。
（2） 完 善 Fretha 功 能， 适 配 更 多 细 胞 图 像 分 析 方 法。Fretha 目 前 支 持 E-FRET、
33 -FRET、L-FRET 和 DC-FRET 等分析方法。未来可根据用户需求，增加更多的分析方
法和功能模块，如凋亡分析、细胞周期分析等。Fretha 还可以通过引入开源深度学习推
理库，如 OpenVINO、TensorRT 等，集成深度学习算法，丰富自动数据处理的算法库。
参考 ilastik 的模块化设计，后续可以将不同的分析方法和功能模块集成到 Fretha 中，用
户可以自行选择需要的模块进行数据处理。
（3）搭建数据库和云服务平台。Fretha 目前仅支持本地数据管理，未来可考虑搭
建云服务平台，实现数据的在线存储、共享和分析，提高数据的可访问性和可用性。
Fretha 的自动数据处理庞大的药物筛选数据也可以通过云服务进行分析，提高数据的处
理效率。
通过持续迭代，Fretha 将逐步发展为集高效性、准确性和易用性于一体的 FRET 数
据分析平台，为蛋白质互作研究和药物开发提供更强大的技术支持。

第 66 页

FRET 双杂交分析数据处理软件的设计与开发

参考文献
[1]

Förster T. Zwischenmolekulare energiewanderung und fluoreszenz [J]. Annalen der
physik. 1948, 437 (1-2): 55–75.

[2]

Lakowicz J R. Principles of fluorescence spectroscopy [M]. Springer, 2006.

[3]

Yung-Chi C, Prusoff W H. Relationship between the inhibition constant (KI) and the
concentration of inhibitor which causes 50 per cent inhibition (I50) of an enzymatic
reaction [J]. Biochemical pharmacology. 1973, 22 (23): 3099–3108.

[4]

Yekta A, Duhamel J, Winnik M A. Dipole-dipole electronic energy transfer. Fluorescence decay functions for arbitrary distributions of donors and acceptors: systems with
planar geometry [J]. Chemical physics letters. 1995, 235 (1-2): 119–125.

[5]

Son H, Mo W, Park J, et al. Single-Molecule FRET Detection of Sub-Nanometer Distance Changes in the Range below a 3-Nanometer Scale [J]. Biosensors. 2020, 10 (11):
168.

[6]

Wu B, Zhang H, Sun R, et al. Translocation kinetics and structural dynamics of ribosomes
are modulated by the conformational plasticity of downstream pseudoknots [J]. Nucleic
acids research. 2018, 46 (18): 9736–9748.

[7]

Shrestha D, Jenei A, Nagy P, et al. Understanding FRET as a research tool for cellular
studies [J]. International journal of molecular sciences. 2015, 16 (4): 6718–6756.

[8]

Chudakov D M, Matz M V, Lukyanov S, et al. Fluorescent proteins and their applications
in imaging living cells and tissues [J]. Physiological reviews. 2010, 90 (3): 1103–1163.

[9]

Shimomura O. Discovery of green fluorescent protein (GFP)(Nobel Lecture) [J]. Angewandte Chemie International Edition. 2009, 48 (31): 5590–5602.

[10]

Sekar R B, Periasamy A. Fluorescence resonance energy transfer (FRET) microscopy
imaging of live cell protein localizations [J]. The Journal of cell biology. 2003, 160 (5):
629.
第 67 页

华南师范大学硕士学位论文

[11]

Cornea R L, Nitu F, Gruber S, et al. FRET-based mapping of calmodulin bound to the
RyR1 Ca2+ release channel [J]. Proceedings of the National Academy of Sciences. 2009,
106 (15): 6128–6133.

[12]

Yoon S, Pan Y, Shung K, et al. FRET-based Ca2+ biosensor single cell imaging interrogated by high-frequency ultrasound [J]. Sensors. 2020, 20 (17): 4998.

[13]

Han Y, Yang J, Li Y, et al. Bright and sensitive red voltage indicators for imaging action potentials in brain slices and pancreatic islets [J]. Science Advances. 2023, 9 (47):
eadi4208.

[14]

Carmona A K, Juliano M A, Juliano L. The use of Fluorescence Resonance Energy Transfer (FRET) peptidesfor measurement of clinically important proteolytic enzymes [J]. Anais da Academia Brasileira de Ciências. 2009, 81: 381–392.

[15]

Walter E R, Ge Y, Mason J C, et al. A coumarin–porphyrin FRET break-apart probe
for heme Oxygenase-1 [J]. Journal of the American Chemical Society. 2021, 143 (17):
6460–6469.

[16]

Cheppali S K, Li C, Xing W, et al. Single-molecule two-and three-colour FRET studies
reveal a transition state in SNARE disassembly by NSF [J]. Nature Communications.
2025, 16 (1): 250.

[17]

Fan L, Tang Y, Liu J, et al. Mechanical Activation of cPLA2 Impedes Fatty Acid βOxidation in Vein Grafts [J]. Advanced Science. 2025, 12 (3): 2411559.

[18]

Song Y, Madahar V, Liao J. Development of FRET assay into quantitative and highthroughput screening technology platforms for protein–protein interactions [J]. Annals
of biomedical engineering. 2011, 39: 1224–1234.

[19]

Sun P, Zhang H, Sun Y, et al. The recent development of fluorescent probes for the
detection of NADH and NADPH in living cells and in vivo [J]. Spectrochimica Acta
Part A: Molecular and Biomolecular Spectroscopy. 2021, 245: 118919.

[20]

Bozza W P, Di X, Takeda K, et al. The use of a stably expressed FRET biosensor for
determining the potency of cancer drugs [J]. PLoS One. 2014, 9 (9): e107010.
第 68 页

FRET 双杂交分析数据处理软件的设计与开发

[21]

Ben-Johny M, Yue D T D N, Yue D T D N. Detecting stoichiometry of macromolecular
complexes in live cells using FRET [J]. Nature Communications. 2016, 7 (1): 13709–
13709.

[22]

Yang F, Qu W, Du M, et al. Stoichiometry and regulation network of Bcl-2 family complexes quantified by live-cell FRET assay [J]. Cellular and Molecular Life Sciences.
2020, 77: 2387–2406.

[23]

Yang Y, Yu Z, Geng J, et al. Cytosolic peptides encoding CaV1 C-termini downregulate the calcium channel activity-neuritogenesis coupling [J]. Communications biology.
2022, 5 (1): 484.

[24]

Awais M, Sato M, Sasaki K, et al. A genetically encoded fluorescent indicator capable of discriminating estrogen agonists from antagonists in living cells. [J]. Analytical
Chemistry. 2004, 76 (8): 2181.

[25]

Aye-Han N N, Ni Q, Zhang J. Fluorescent biosensors for real-time tracking of posttranslational modification dynamics [J]. Current Opinion in Chemical Biology. 2009,
13 (4): 392–397.

[26]

Liu B, Mavrova S N, van den Berg J, et al. Influence of fluorescent protein maturation
on FRET measurements in living cells [J]. ACS sensors. 2018, 3 (9): 1735–1742.

[27]

Erickson M G, Alseikhan B A, Peterson B Z, et al. Preassociation of calmodulin with
voltage-gated Ca2+ channels revealed by FRET in single living cells [J]. Neuron. 2001,
31 (6): 973–985.

[28]

Chen H, Puhl H L, Koushik S V, et al. Measurement of FRET efficiency and ratio of
donor to acceptor concentration in living cells [J]. Biophysical journal. 2006, 91 (5):
L39–L41.

[29]

Zhao H, Li W, Chu W, et al. Quantitative Analysis of Protein Self-Association by Sedimentation Velocity [J]. Current protocols in protein science. 2020, 101 (1): e109.

[30]

Clark S, Mitra J, Elferich J, et al. Single molecule studies of the native hair cell
mechanosensory transduction complex [J]. bioRxiv. 2023.
第 69 页

华南师范大学硕士学位论文

[31]

Cui Y, Zhang X, Yu M, et al. Techniques for detecting protein-protein interactions in
living cells: principles, limitations, and recent progress [J]. Science China Life Sciences.
2019, 62: 619–632.

[32]

Butz E S, Ben-Johny M, Shen M, et al. Quantifying macromolecular interactions in living
cells using FRET two-hybrid assays [J]. Nature Protocols. 2016, 11 (12): 2470–2498.

[33]

Du M, Yang F, Mai Z, et al. FRET two-hybrid assay by linearly fitting FRET efficiency
to concentration ratio between acceptor and donor [J]. Applied Physics Letters. 2018,
112 (15): 153702.

[34]

Zhou S, Miao Y, Qiu H, et al. Deep learning based local feature classification to automatically identify single molecule fluorescence events [J]. Communications Biology.
2024, 7 (1): 1404.

[35]

Li J, Zhang L, Johnson-Buck A, et al. Automatic classification and segmentation of
single-molecule fluorescence time traces with deep learning [J]. Nature Communications. 2020, 11 (1): 5833.

[36]

Zhang L, Li J, Walter N G. Pretrained Deep Neural Network Kin-SiM for SingleMolecule FRET Trace Idealization [J]. The Journal of Physical Chemistry B. 2025.

[37]

Ronneberger O, Fischer P, Brox T. U-net: Convolutional networks for biomedical image segmentation [C]. In Medical image computing and computer-assisted intervention–
MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015,
proceedings, part III 18. 2015: 234–241.

[38]

Ge L, Liu F, Luo J. Highly-efficient quantitative fluorescence resonance energy transfer
measurements based on deep learning [J]. Journal of Innovative Optical Health Sciences.
2020, 13 (06): 2050021.

[39]

Thomsen J, Sletfjerding M B, Jensen S B, et al. DeepFRET, a software for rapid and
automated single-molecule FRET data classification using deep learning [J]. Elife. 2020,
9: e60404.
第 70 页

FRET 双杂交分析数据处理软件的设计与开发

[40]

Feldmann C, Schänzler M, Ben-Johny M, et al. Protocol for deriving proximity, affinity, and stoichiometry of protein interactions using image-based quantitative two-hybrid
FRET [J]. STAR Protocols. 2023, 4 (3): 102459.

[41]

Kromp F, Bozsaky E, Rifatbegovic F, et al. An annotated fluorescence image dataset for
training nuclear segmentation methods [J]. Scientific Data. 2020, 7 (1): 262.

[42]

Langer M, He Z, Rahayu W, et al. Distributed Training of Deep Learning Models: A Taxonomic Perspective [J]. IEEE Transactions on Parallel and Distributed Systems. 2020,
31 (12): 2802–2818.

[43]

Huang Y, Cheng Y, Bapna A, et al. GPipe: Efficient Training of Giant Neural Networks
using Pipeline Parallelism [C]. In Advances in Neural Information Processing Systems.
2018.

[44]

Zhang Y, Tiňo P, Leonardis A, et al. A survey on neural network interpretability [J]. IEEE
Transactions on Emerging Topics in Computational Intelligence. 2021, 5 (5): 726–742.

[45]

Fan F-L, Xiong J, Li M, et al. On interpretability of artificial neural networks: A survey [J]. IEEE Transactions on Radiation and Plasma Medical Sciences. 2021, 5 (6):
741–760.

[46]

陆文周. Qt5 开发及实例. 第 2 版 [M]. Qt5 开发及实例. 第 2 版, 2015.

[47]

Bradski G. The opencv library. [J]. Dr. Dobb’s Journal: Software Tools for the Professional Programmer. 2000, 25 (11): 120–123.

[48]

Bradski G, Kaehler A. Learning OpenCV: Computer vision with the OpenCV library [M]. ” O’Reilly Media, Inc.”, 2008.

[49]

Gurcan F, Dalveren G G M, Cagiltay N E, et al. Evolution of software testing strategies
and trends: Semantic content analysis of software research corpus of the last 40 years [J].
IEEE Access. 2022, 10: 106093–106109.

[50]

Wang R, Artho C, Kristensen1 L M, et al. Software testing [C]. In Integrated Formal
Methods: 15th International Conference, IFM 2019, Bergen, Norway, December 2–6,
2019, Proceedings. 2019: 474.
第 71 页

华南师范大学硕士学位论文

[51]

Koushik S V, Chen H, Thaler C, et al. Cerulean, Venus, and VenusY67C FRET reference
standards [J]. Biophysical journal. 2006, 91 (12): L99–L101.

[52]

Thaler C, Koushik S V, Blank P S, et al. Quantitative multiphoton spectral imaging and
its use for measuring resonance energy transfer [J]. Biophysical journal. 2005, 89 (4):
2736–2749.

[53]

Warren C F, Wong-Brown M W, Bowden N A. BCL-2 family isoforms in apoptosis and
cancer [J]. Cell death & disease. 2019, 10 (3): 177.

[54]

Sun B, Chen H, Wang X, et al. Regorafenib induces Bim-mediated intrinsic apoptosis by
blocking AKT-mediated FOXO3a nuclear export [J]. Cell Death Discovery. 2023, 9 (1):
37.

[55]

Sun H, Zhang C, Yuan Y, et al. Automated ExEm-spFRET Microscope [J]. Microscopy
and Microanalysis. 2022, 28 (2): 330–337.

[56]

Kirillov A, Mintun E, Ravi N, et al. Segment anything [C]. In Proceedings of the
IEEE/CVF International Conference on Computer Vision. 2023: 4015–4026.

[57]

Cheng J, Ye J, Deng Z, et al. Sam-med2d [J]. arXiv preprint arXiv:2308.16184. 2023.

[58]

Zhang Y, Shen Z, Jiao R. Segment anything model for medical image segmentation: Current applications and future directions [J]. Computers in Biology and Medicine. 2024:
108238.

[59]

Jagadeeswari M, Manikandababu C, Aiswarya M. Integral Images: Efficient Algorithms
for Their Computation Systems of Speeded-Up Robust Features (Surf) [C]. In Pervasive
Computing and Social Networking: Proceedings of ICPCSN 2021. 2022: 663–672.

[60]

Qu W, Du M, Yang F, et al. Gaussian FRET two-hybrid assays for determining the stoichiometry of hetero-oligomeric complexes in single living cells [J]. Biochemical and
Biophysical Research Communications. 2019.

[61]

Gedraite E S, Hadad M. Investigation on the effect of a Gaussian Blur in image filtering
and segmentation [C]. In Proceedings ELMAR-2011. 2011: 393–396.
第 72 页

FRET 双杂交分析数据处理软件的设计与开发

[62]

Sun H, Zhang C, Ma Y, et al. Controlling and online measurement of automatic
dual-channel E-FRET microscope [J]. Biomedical signal processing and control. 2019,
53 (Aug.): 101585.1–101585.9.

[63]

Wang L, Doherty G A, Judd A S, et al. Discovery of A-1331852, a first-in-class, potent,
and orally-bioavailable BCL-XL inhibitor [J]. ACS medicinal chemistry letters. 2020,
11 (10): 1829–1836.

[64]

Kuusanmäki H, Dufva O, Vähä-Koskela M, et al. Erythroid/megakaryocytic differentiation confers BCL-XL dependency and venetoclax resistance in acute myeloid
leukemia [J]. Blood. 2023, 141 (13): 1610–1625.

第 73 页

FRET 双杂交分析数据处理软件的设计与开发

本文创新性说明
（1）本论文第四章对应研究成果已经发表在三区（中科院分区）或 EI 收录杂志上；
（2）本论文第二章对应研究成果已经获批软件著作权一件。

第 74 页

